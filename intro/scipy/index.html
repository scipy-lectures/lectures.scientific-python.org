<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.5. SciPy : high-level scientific computing &#8212; Scientific Python Lectures</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=c29d3f28" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss@3.0.0/build/base-min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/foldable_toc.css?v=38a22cee" />
    <script src="../../_static/documentation_options.js?v=3d051f0c"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=0729d509"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="../../_static/scroll_highlight_toc.js?v=cbac5d29"></script>
    <script src="../../_static/foldable_toc.js?v=d65ca516"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.5.11.1. Maximum wind speed prediction at the Sprogø station" href="summary-exercises/stats-interpolate.html" />
    <link rel="prev" title="Text printing decorated" href="../matplotlib/auto_examples/pretty_plots/plot_text_ext.html" />
 

<script defer data-domain="lectures.scientific-python.org" src="https://views.scientific-python.org/js/script.js"></script>

  </head><body>
    <!-- Use the header to add javascript -->
    

    <script type="text/javascript">
     // Function to toggle tip div
     function toggle_tip_div(obj) {
       $(obj).find("p.summary").remove();

       var content = $(obj).text();
       var html = $(obj).html();

       if ($(obj).hasClass("collapsed")) {
         // Expand
         $(obj).html('<p class="summary"><img src="../../_static/minus.png"></p>' + html);
       } else {
         // Collapse
         if(content.length > 50) {
           content = content.substr(0, 47);
         }
         $(obj).html('<p class="summary"><img src="../../_static/plus.png">' + content + '...</p>' + html);
       }

       $(obj).toggleClass("collapsed");
     }

     $(document).ready(function () {
       $(".tip").each(function() {
         $(this).find("p.admonition-title").remove();
       });
       // Collapse all tips and add plus sign
       $(".tip").each(function() { toggle_tip_div($(this)); });

       $(".tip")
         .click(function(event){
           // Change state of the global button
           $('div.related li.transparent').removeClass('transparent');
           toggle_tip_div($(this));
           if (event.target.tagName.toLowerCase() != "a") {
             return true; //Makes links clickable
           }
         });
     });
    </script>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.5.11.1. Maximum wind speed prediction at the Sprogø station"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../matplotlib/auto_examples/pretty_plots/plot_text_ext.html" title="Text printing decorated"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scientific Python Lectures</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U"><span class="section-number">1. </span>Getting started with Python for science</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1.5. </span>SciPy : high-level scientific computing</a></li>
     
    <!-- Insert a tip toggle in the navigation bar -->
        <li class="left">
        <!-- On click, expand all tips -->
        <!--
        <a>
            <img src="../../_static/plus.png"
                 alt="Expand tips" style="padding: 1ex;"/>
            <span class="hiddenlink">Collapse document to compact view</span>
        </a>
        -->
        </li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scientific-python-lectures/edit/main/intro/scipy/index.rst">Edit
      <span class="tooltip">
        Improve this page:<br/>Edit it on Github.
      </span>
    </a>
    </li>
    
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="scipy-high-level-scientific-computing">
<span id="scipy"></span><h1><span class="section-number">1.5. </span>SciPy : high-level scientific computing<a class="headerlink" href="#scipy-high-level-scientific-computing" title="Link to this heading">¶</a></h1>
<p><strong>Authors</strong>: <em>Gaël Varoquaux, Adrien Chauve, Andre Espaze, Emmanuelle Gouillart, Ralf Gommers</em></p>
<aside class="topic">
<p class="topic-title">Scipy</p>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> package contains various toolboxes dedicated to common
issues in scientific computing. Its different submodules correspond
to different applications, such as interpolation, integration,
optimization, image processing, statistics, special functions, etc.</p>
</aside>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> can be compared to other standard scientific-computing
libraries, such as the GSL (GNU Scientific  Library for C and C++),
or Matlab’s toolboxes. <code class="docutils literal notranslate"><span class="pre">scipy</span></code> is the core package for scientific
routines in Python; it is meant to operate efficiently on <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
arrays, so that NumPy and SciPy work hand in hand.</p>
<p>Before implementing a routine, it is worth checking if the desired
data processing is not already implemented in SciPy. As
non-professional programmers, scientists often tend to <strong>re-invent the
wheel</strong>, which leads to buggy, non-optimal, difficult-to-share and
unmaintainable code. By contrast, <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>’s routines are optimized
and tested, and should therefore be used when possible.</p>
</div>
<nav class="contents local" id="chapters-contents">
<p class="topic-title">Chapters contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#file-input-output-scipy-io" id="id2">File input/output: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#special-functions-scipy-special" id="id3">Special functions: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#linear-algebra-operations-scipy-linalg" id="id4">Linear algebra operations: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#interpolation-scipy-interpolate" id="id5">Interpolation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#optimization-and-fit-scipy-optimize" id="id6">Optimization and fit: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#statistics-and-random-numbers-scipy-stats" id="id7">Statistics and random numbers: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#numerical-integration-scipy-integrate" id="id8">Numerical integration: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#fast-fourier-transforms-scipy-fft" id="id9">Fast Fourier transforms: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#signal-processing-scipy-signal" id="id10">Signal processing: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#image-manipulation-scipy-ndimage" id="id11">Image manipulation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></a></p></li>
<li><p><a class="reference internal" href="#summary-exercises-on-scientific-computing" id="id12">Summary exercises on scientific computing</a></p></li>
<li><p><a class="reference internal" href="#full-code-examples-for-the-scipy-chapter" id="id13">Full code examples for the SciPy chapter</a></p></li>
</ul>
</nav>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This tutorial is far from an introduction to numerical computing.
As enumerating the different submodules and functions in SciPy would
be very boring, we concentrate instead on a few examples to give a
general idea of how to use <code class="docutils literal notranslate"><span class="pre">scipy</span></code> for scientific computing.</p>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/index.html#module-scipy" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code></a> is composed of task-specific sub-modules:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>They all depend on <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v1.26)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy</span></code></a>, but are mostly independent of each
other. The standard way of importing NumPy and these SciPy modules
is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div></pre></div>
</div>
</div>
<section id="file-input-output-scipy-io">
<h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">1.5.1. </span>File input/output: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a></a><a class="headerlink" href="#file-input-output-scipy-io" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a> contains functions for loading and saving data in
several common formats including Matlab, IDL, Matrix Market, and
Harwell-Boeing.</p>
<p><strong>Matlab files</strong>: Loading and saving:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span>  <span class="c1"># savemat expects a dictionary</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Python / Matlab mismatch</strong>: The Matlab file format does not support 1D arrays.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([1.,  1.,  1.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(3,)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;file.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span>
<div class="newline"></div><span class="go">array([[1.,  1.,  1.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(1, 3)</span>
<div class="newline"></div></pre></div>
</div>
<p>Notice that the original array was a one-dimensional array, whereas the
saved and reloaded array is a two-dimensional array with a single row.</p>
<p>For other formats, see the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/io.html#module-scipy.io" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a> documentation.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p>Load text files: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.loadtxt()</span></code></a>/<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.savetxt.html#numpy.savetxt" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.savetxt()</span></code></a></p></li>
<li><p>Clever loading of text/csv files:
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.genfromtxt.html#numpy.genfromtxt" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.genfromtxt()</span></code></a></p></li>
<li><p>Fast and efficient, but NumPy-specific, binary format:
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.save.html#numpy.save" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.save()</span></code></a>/<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.load()</span></code></a></p></li>
<li><p>Basic input/output of images in Matplotlib:
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imread.html#matplotlib.pyplot.imread" title="(in Matplotlib v3.8.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imread()</span></code></a>/<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imsave.html#matplotlib.pyplot.imsave" title="(in Matplotlib v3.8.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imsave()</span></code></a></p></li>
<li><p>More advanced input/output of images: <a class="reference external" href="https://imageio.readthedocs.io/en/stable/index.html#module-imageio" title="(in imageio v2.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">imageio</span></code></a></p></li>
</ul>
</div>
</section>
<section id="special-functions-scipy-special">
<h2><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">1.5.2. </span>Special functions: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a></a><a class="headerlink" href="#special-functions-scipy-special" title="Link to this heading">¶</a></h2>
<p>“Special” functions are functions commonly used in science and mathematics that
are not considered to be “elementary” functions. Examples include</p>
<blockquote>
<div><ul class="simple">
<li><p>the gamma function, <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.gamma()</span></code>,</p></li>
<li><p>the error function, <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.erf()</span></code>,</p></li>
<li><p>Bessel functions, such as <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.jv()</span></code>
(Bessel functions of the first kind), and</p></li>
<li><p>elliptic functions, such as <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.ellipj()</span></code>
(Jacobian elliptic functions).</p></li>
</ul>
</div></blockquote>
<p>Other special functions are combinations of familiar elementary functions,
but they offer better accuracy or robustness than their naive implementations
would.</p>
<p>Most of these function are computed elementwise and follow standard
NumPy broadcasting rules when the input arrays have different shapes.
For example, <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.xlog1py()</span></code> is mathematically equivalent
to <img class="math" src="../../_images/math/8541874d928de93059cb6c80dba0a159df9629bd.png" alt="x\log(1 + y)"/>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">xlog1py</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(3, 2)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>However, it is numerically favorable for small <img class="math" src="../../_images/math/1b5e577d6216dca3af7d87aa122a0b9b360d6cb3.png" alt="y"/>, when explicit addition
of <code class="docutils literal notranslate"><span class="pre">1</span></code> would lead to loss of precision due to floating point truncation error.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">2.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="mf">1e-18</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<div class="newline"></div><span class="go">0.0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">xlog1py</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<div class="newline"></div><span class="go">2.5e-18</span>
<div class="newline"></div></pre></div>
</div>
<p>Many special functions also have “logarithmized” variants. For instance,
the gamma function <img class="math" src="../../_images/math/7d767328ef6b86579716f3e74a335f813877a85b.png" alt="\Gamma(\cdot)"/> is related to the factorial
function by <img class="math" src="../../_images/math/cfdd81f596c0dea49f61c49ed02f34befe15d28f.png" alt="n! = \Gamma(n + 1)"/>, but it extends the domain from the
positive integers to the complex plane.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mf">5.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>The factorial function grows quickly, and so the gamma function overflows
for moderate values of the argument. However, sometimes only the logarithm
of the gamma function is needed. In such cases, we can compute the logarithm
of the gamma function directly using <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.gammaln()</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<div class="newline"></div><span class="go">array([  3.17805383, 144.56574395,          inf])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([   3.17805383,  144.56574395, 2605.11585036])</span>
<div class="newline"></div></pre></div>
</div>
<p>Such functions can often be used when the intermediate components of a
calculation would overflow or underflow, but the final result would not.
For example, suppose we wish to compute the ratio
<img class="math" src="../../_images/math/7c7156d7dbdbc834ec4f109761df1373fafcb1a0.png" alt="\Gamma(500)/\Gamma(499)"/>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">499</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<div class="newline"></div><span class="go">(inf, inf)</span>
<div class="newline"></div></pre></div>
</div>
<p>Both the numerator and denominator overflow, so performing $a / b$ will
not return the result we seek. However, the magnitude of the result should
be moderate, so the use of logarithms comes to mind. Combining the identities
<img class="math" src="../../_images/math/6a6979550340d17853900a96d31fb5f1fadccd9e.png" alt="\log(a/b) = \log(a) - \log(b)"/> and <img class="math" src="../../_images/math/7d094aa25244e4791ce63efd7e0142c8670b43ee.png" alt="\exp(\log(x)) = x"/>,
we get:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_a</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">log_b</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">499</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">log_res</span> <span class="o">=</span> <span class="n">log_a</span> <span class="o">-</span> <span class="n">log_b</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_res</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<div class="newline"></div><span class="go">499.0000000...</span>
<div class="newline"></div></pre></div>
</div>
<p>Similarly, suppose we wish to compute the difference
<img class="math" src="../../_images/math/0b6cd9ac7d5e7217338ca91ae922863948d8fa8e.png" alt="\log(\Gamma(500) - \Gamma(499))"/>. For this, we use
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.logsumexp.html#scipy.special.logsumexp" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.special.logsumexp()</span></code></a>, which computes
<img class="math" src="../../_images/math/11dc922569f51ceacd6cec750f4fd03237a29fd0.png" alt="\log(\exp(x) + \exp(y))"/> using a numerical trick that avoids overflow.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">logsumexp</span><span class="p">([</span><span class="n">log_a</span><span class="p">,</span> <span class="n">log_b</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                           <span class="n">b</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># weights the terms of the sum</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<div class="newline"></div><span class="go">2605.113844343...</span>
<div class="newline"></div></pre></div>
</div>
<p>For more information about these and many other special functions, see
the documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html#module-scipy.special" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a>.</p>
</section>
<section id="linear-algebra-operations-scipy-linalg">
<span id="scipy-linalg"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">1.5.3. </span>Linear algebra operations: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></a><a class="headerlink" href="#linear-algebra-operations-scipy-linalg" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a> provides a Python interface to efficient, compiled
implementations of standard linear algebra operations: the BLAS (Basic
Linear Algebra Subroutines) and LAPACK (Linear Algebra PACKage) libraries.</p>
<p>For example, the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.det.html#scipy.linalg.det" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.det()</span></code></a> function computes the determinant
of a square matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<div class="newline"></div><span class="go">-2.0</span>
<div class="newline"></div></pre></div>
</div>
<p>Mathematically, the solution of a linear system <img class="math" src="../../_images/math/6525336972790f2bd6fb9c5d9ed3a17262d22fe9.png" alt="Ax = b"/> is <img class="math" src="../../_images/math/73d945da5a77c767b80fa2bc0e9b08d70efa5782.png" alt="x = A^{-1}b"/>,
but explicit inversion of a matrix is numerically unstable and should be avoided.
Instead, use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.solve.html#scipy.linalg.solve" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.solve()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">,</span> <span class="mi">23</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<div class="newline"></div><span class="go">array([4., 5.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Linear systems with special structure can often be solved more efficiently
than more general systems. For example, systems with triangular matrices
can be solved using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.solve_triangular.html#scipy.linalg.solve_triangular" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.solve_triangular()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">A_upper</span>
<div class="newline"></div><span class="go">array([[1, 2],</span>
<div class="newline"></div><span class="go">       [0, 3]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve_triangular</span><span class="p">(</span><span class="n">A_upper</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<div class="newline"></div><span class="gp">... </span>            <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_upper</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a> also features matrix factorizations/decompositions
such as the singular value decomposition.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>  <span class="c1"># singular values</span>
<div class="newline"></div><span class="go">array([4.23606798, 0.23606798])</span>
<div class="newline"></div></pre></div>
</div>
<p>The original matrix can be recovered by matrix multiplication of the
factors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># convert to diagonal matrix before matrix multiplication</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">A2</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">S</span> <span class="o">@</span> <span class="n">Vh</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">A3</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">*</span> <span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">Vh</span>  <span class="c1"># more efficient: use array math broadcasting rules!</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Many other decompositions (e.g. LU, Cholesky, QR), solvers for structured
linear systems (e.g. triangular, circulant), eigenvalue problem algorithms,
matrix functions (e.g. matrix exponential), and routines for special matrix
creation (e.g. block diagonal, toeplitz) are available in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a>.</p>
</section>
<section id="interpolation-scipy-interpolate">
<span id="intro-scipy-interpolate"></span><h2><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">1.5.4. </span>Interpolation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></a><a class="headerlink" href="#interpolation-scipy-interpolate" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a> is useful for fitting a function from experimental
data and thus evaluating points where no reference value exists. The module
includes, but not limited to <a class="reference external" href="https://netlib.org/dierckx/index.html">FITPACK Fortran subroutines</a>.</p>
<p>By imagining experimental data close to a sine function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">measured_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">measures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">measured_time</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
<div class="newline"></div></pre></div>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a> has many interpolation methods which need to be
chosen based on the data. See the
<a class="reference external" href="https://scipy.github.io/devdocs/tutorial/interpolate.html">tutorial</a>
for some guidelines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spline</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">CubicSpline</span><span class="p">(</span><span class="n">measured_time</span><span class="p">,</span> <span class="n">measures</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_interpolation.html"><img alt="../../_images/sphx_glr_plot_interpolation_001.png" class="align-right" src="../../_images/sphx_glr_plot_interpolation_001.png" style="width: 360.0px; height: 240.0px;" /></a>
<p>Then the result can be evaluated at the time of interest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interpolation_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">linear_results</span> <span class="o">=</span> <span class="n">spline</span><span class="p">(</span><span class="n">interpolation_time</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.CloughTocher2DInterpolator.html#scipy.interpolate.CloughTocher2DInterpolator" title="(in SciPy v1.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.interpolate.CloughTocher2DInterpolator</span></code></a> is similar to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.CubicSpline.html#scipy.interpolate.CubicSpline" title="(in SciPy v1.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.interpolate.CubicSpline</span></code></a>, but for 2-D arrays.
See the summary exercise on
<a class="reference internal" href="summary-exercises/stats-interpolate.html#summary-exercise-stat-interp"><span class="std std-ref">Maximum wind speed prediction at the Sprogø station</span></a> for a more advanced spline
interpolation example.</p>
</section>
<section id="optimization-and-fit-scipy-optimize">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">1.5.5. </span>Optimization and fit: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a></a><a class="headerlink" href="#optimization-and-fit-scipy-optimize" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a> provides algorithms for root finding, curve fitting,
and more general optimization.</p>
<section id="root-finding">
<h3><span class="section-number">1.5.5.1. </span>Root Finding<a class="headerlink" href="#root-finding" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root_scalar.html#scipy.optimize.root_scalar" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root_scalar()</span></code></a> attempts to find a root of a specified
scalar-valued function (i.e., an argument at which the function value is zero).
Like many <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a> functions, the function needs an initial
guess of the solution, which the algorithm will refine until it converges or
recognizes failure. We also provide the derivative to improve the rate of
convergence.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># guess</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">fprime</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<div class="newline"></div><span class="go">      converged: True</span>
<div class="newline"></div><span class="go">           flag: converged</span>
<div class="newline"></div><span class="go"> function_calls: 12</span>
<div class="newline"></div><span class="go">     iterations: 6</span>
<div class="newline"></div><span class="go">           root: 1.0</span>
<div class="newline"></div><span class="go">         method: newton</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>None of the functions in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a> that accept a guess are
guaranteed to converge for all possible guesses! (For example, try
<code class="docutils literal notranslate"><span class="pre">x0=1.5</span></code> in the example above, where the derivative of the function is
exactly zero.) If this occurs, try a different guess, adjust the options
(like providing a <code class="docutils literal notranslate"><span class="pre">bracket</span></code> as shown below), or consider whether SciPy
offers a more appropriate method for the problem.</p>
</div>
<p>Note that only one the root at <code class="docutils literal notranslate"><span class="pre">1.0</span></code> is found. By inspection, we can tell
that there is a second root at <code class="docutils literal notranslate"><span class="pre">2.0</span></code>. We can direct the function toward a
particular root by changing the guess or by passing a bracket that contains
only the root we seek.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">root_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">root</span>
<div class="newline"></div><span class="go">2.0</span>
<div class="newline"></div></pre></div>
</div>
<p>For multivariate problems, use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="c1"># intersection of unit circle and line from origin</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>            <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Over-constrained problems can be solved in the least-squares
sense using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">method='lm'</span></code>
(Levenberg-Marquardt).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="c1"># intersection of unit circle, line from origin, and parabola</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>            <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>            <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">success</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">x</span>
<div class="newline"></div><span class="go">array([0.76096066, 0.66017736])</span>
<div class="newline"></div></pre></div>
</div>
<p>See the documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root_scalar.html#scipy.optimize.root_scalar" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root_scalar()</span></code></a>
and <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a> for a variety of other solution
algorithms and options.</p>
</section>
<section id="curve-fitting">
<h3><span class="section-number">1.5.5.2. </span>Curve fitting<a class="headerlink" href="#curve-fitting" title="Link to this heading">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_curve_fit.html"><img alt="../../_images/sphx_glr_plot_curve_fit_001.png" class="align-right" src="../../_images/sphx_glr_plot_curve_fit_001.png" style="width: 300.0px; height: 200.0px;" /></a>
<p>Suppose we have data that is sinusoidal but noisy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>  <span class="c1"># 50 values between -5 and 5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">1.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
<div class="newline"></div></pre></div>
</div>
<p>We can approximate the underlying amplitude, frequency, and phase
from the data by least squares curve fitting. To begin, we write
a function that accepts the independent variable as the first
argument and all parameters to fit as separate arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_curve_fit.html"><img alt="../../_images/sphx_glr_plot_curve_fit_002.png" class="align-right" src="../../_images/sphx_glr_plot_curve_fit_002.png" style="width: 300.0px; height: 200.0px;" /></a>
<p>We then use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code></a> to find <img class="math" src="../../_images/math/b3e65e3b6408fcfa00452530b73f55d1755f9965.png" alt="a"/> and <img class="math" src="../../_images/math/68c7c8c65602677ab56cf7fd88002023f0edc575.png" alt="b"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<div class="newline"></div><span class="go">array([2.900026  , 1.50012043, 1.57079633])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># what we&#39;d expect</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><aside class="topic green">
<p class="topic-title">Exercise: Curve fitting of temperature data</p>
<blockquote>
<div><p>The temperature extremes in Alaska for each month, starting in January, are
given by (in degrees Celsius):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">:</span>  <span class="mi">17</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">21</span><span class="p">,</span>  <span class="mi">28</span><span class="p">,</span>  <span class="mi">33</span><span class="p">,</span>  <span class="mi">38</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span>  <span class="mi">37</span><span class="p">,</span>  <span class="mi">31</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span>  <span class="mi">19</span><span class="p">,</span>  <span class="mi">18</span>
<div class="newline"></div><span class="nb">min</span><span class="p">:</span> <span class="o">-</span><span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span>
<div class="newline"></div></pre></div>
</div>
<ol class="arabic simple">
<li><p>Plot these temperature extremes.</p></li>
<li><p>Define a function that can describe min and max temperatures.
Hint: this function has to have a period of 1 year.
Hint: include a time offset.</p></li>
<li><p>Fit this function to the data with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code></a>.</p></li>
<li><p>Plot the result.  Is the fit reasonable?  If not, why?</p></li>
<li><p>Is the time offset for min and max temperatures the same within the fit
accuracy?</p></li>
</ol>
<p><a class="reference internal" href="auto_examples/solutions/plot_curvefit_temperature_data.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-curvefit-temperature-data-py"><span class="std std-ref">solution</span></a></p>
</div></blockquote>
</aside>
</section>
<section id="optimization">
<h3><span class="section-number">1.5.5.3. </span>Optimization<a class="headerlink" href="#optimization" title="Link to this heading">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_optimize_example1.html"><img alt="../../_images/sphx_glr_plot_optimize_example1_001.png" class="align-right" src="../../_images/sphx_glr_plot_optimize_example1_001.png" style="width: 320.0px; height: 240.0px;" /></a>
<p>Suppose we wish to minimize the scalar-valued function of a single
variable <img class="math" src="../../_images/math/138e8ce9298cacde7eafbdc6bc8003fdbc946e3e.png" alt="f(x) = x^2  + 10 \sin(x)"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<p>We can see that the function has a local minimizer near <img class="math" src="../../_images/math/afff23ba884b6fbae79ace252b09530139e22d05.png" alt="x = 3.8"/>
and a global minimizer near <img class="math" src="../../_images/math/a86d99a0863486e1d517410dce7c94011915bf8f.png" alt="x = -1.3"/>, but
the precise values cannot be determined from the plot.</p>
<p>The most appropriate function for this purpose is
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize_scalar()</span></code></a>.
Since we know the approximate locations of the minima, we will provide
bounds that restrict the search to the vicinity of the global minimum.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<div class="newline"></div><span class="go"> message: Solution found.</span>
<div class="newline"></div><span class="go"> success: True</span>
<div class="newline"></div><span class="go">  status: 0</span>
<div class="newline"></div><span class="go">     fun: -7.9458233756...</span>
<div class="newline"></div><span class="go">       x: -1.306440997...</span>
<div class="newline"></div><span class="go">     nit: 8</span>
<div class="newline"></div><span class="go">    nfev: 8</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">fun</span> <span class="o">==</span> <span class="n">f</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>If we did not already know the approximate location of the global minimum,
we could use one of SciPy’s global minimizers, such as
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.differential_evolution.html#scipy.optimize.differential_evolution" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.differential_evolution()</span></code></a>. We are required to pass
<code class="docutils literal notranslate"><span class="pre">bounds</span></code>, but they do not need to be tight.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>  <span class="c1"># list of lower, upper bound for each variable</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">differential_evolution</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>  
<div class="newline"></div><span class="go"> message: Optimization terminated successfully.</span>
<div class="newline"></div><span class="go"> success: True</span>
<div class="newline"></div><span class="go">     fun: -7.9458233756...</span>
<div class="newline"></div><span class="go">       x: [-1.306e+00]</span>
<div class="newline"></div><span class="go">     nit: 6</span>
<div class="newline"></div><span class="go">    nfev: 111</span>
<div class="newline"></div><span class="go">     jac: [ 9.948e-06]</span>
<div class="newline"></div></pre></div>
</div>
<p>For multivariate optimization, a good choice for many problems is
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a>.
Suppose we wish to find the minimum of a quadratic function of two
variables, <img class="math" src="../../_images/math/a541a5e8d21b22ed43198b5565c22f60d4680e0d.png" alt="f(x_0, x_1) = (x_0-1)^2 + (x_1-2)^2"/>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div></pre></div>
</div>
<p>Like <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root.html#scipy.optimize.root" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.root()</span></code></a>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a>
requires a guess <code class="docutils literal notranslate"><span class="pre">x0</span></code>. (Note that this is the initial value of
<em>both</em> variables rather than the value of the variable we happened to
label <img class="math" src="../../_images/math/ed7fb0260e58d3ca5851e823ff991dae4cde5671.png" alt="x_0"/>.)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<div class="newline"></div><span class="go">  message: Optimization terminated successfully.</span>
<div class="newline"></div><span class="go">  success: True</span>
<div class="newline"></div><span class="go">   status: 0</span>
<div class="newline"></div><span class="go">      fun: 1.70578...e-16</span>
<div class="newline"></div><span class="go">        x: [ 1.000e+00  2.000e+00]</span>
<div class="newline"></div><span class="go">      nit: 2</span>
<div class="newline"></div><span class="go">      jac: [ 3.219e-09 -8.462e-09]</span>
<div class="newline"></div><span class="go"> hess_inv: [[ 9.000e-01 -2.000e-01]</span>
<div class="newline"></div><span class="go">            [-2.000e-01  6.000e-01]]</span>
<div class="newline"></div><span class="go">     nfev: 9</span>
<div class="newline"></div><span class="go">     njev: 3</span>
<div class="newline"></div></pre></div>
</div>
<aside class="sidebar">
<p class="sidebar-title"><strong>Maximization?</strong></p>
<p>Is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a> restricted to the solution of
minimization problems? Nope! To solve a maximization problem,
simply minimize the <em>negative</em> of the original objective function.</p>
</aside>
<p>This barely scratches the surface of SciPy’s optimization features, which
include mixed integer linear programming, constrained nonlinear programming,
and the solution of assignment problems. For much more information, see the
documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a> and the advanced chapter
<a class="reference internal" href="../../advanced/mathematical_optimization/index.html#mathematical-optimization"><span class="std std-ref">Mathematical optimization: finding minima of functions</span></a>.</p>
<aside class="topic green">
<p class="topic-title">Exercise: 2-D minimization</p>
<blockquote>
<div><a class="reference external image-reference" href="auto_examples/plot_2d_minimization.html"><img alt="../../_images/sphx_glr_plot_2d_minimization_002.png" class="align-right" src="../../_images/sphx_glr_plot_2d_minimization_002.png" style="width: 320.0px; height: 240.0px;" /></a>
<p>The six-hump camelback function</p>
<div class="math">
<p><img src="../../_images/math/7f6cfebfaf24347effe8c0bbd95b70c913609ade.png" alt="f(x, y) = (4 - 2.1x^2 + \frac{x^4}{3})x^2 + xy + (4y^2 - 4)y^2"/></p>
</div><p>has multiple local minima. Find a global minimum (there is more than one,
each with the same value of the objective function) and at least one other
local minimum.</p>
<p>Hints:</p>
<blockquote>
<div><ul class="simple">
<li><p>Variables can be restricted to <img class="math" src="../../_images/math/fe1fb8ccf60a05c9e72e9cec2e8ca7c1f2f62383.png" alt="-2 &lt; x &lt; 2"/> and <img class="math" src="../../_images/math/2d473ef72b0ed054af5ecd6e04c240e3257b838c.png" alt="-1 &lt; y &lt; 1"/>.</p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.meshgrid()</span></code></a> and <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="(in Matplotlib v3.8.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow()</span></code></a> can help
with visualization.</p></li>
<li><p>Try minimizing with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.minimize()</span></code></a> with an initial
guess of <img class="math" src="../../_images/math/6e944c163f314debca021997246a4c2c7caf269e.png" alt="(x, y) = (0, 0)"/>. Does it find the global minimum, or
converge to a local minimum? What about other initial guesses?</p></li>
<li><p>Try minimizing with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.differential_evolution.html#scipy.optimize.differential_evolution" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.differential_evolution()</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p><a class="reference internal" href="auto_examples/plot_2d_minimization.html#sphx-glr-intro-scipy-auto-examples-plot-2d-minimization-py"><span class="std std-ref">solution</span></a></p>
</div></blockquote>
</aside>
<p>See the summary exercise on <a class="reference internal" href="summary-exercises/optimize-fit.html#summary-exercise-optimize"><span class="std std-ref">Non linear least squares curve fitting: application to point extraction in topographical lidar data</span></a> for another, more
advanced example.</p>
</section>
</section>
<section id="statistics-and-random-numbers-scipy-stats">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">1.5.6. </span>Statistics and random numbers: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a></a><a class="headerlink" href="#statistics-and-random-numbers-scipy-stats" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> contains fundamental tools for statistics in Python.</p>
<section id="statistical-distributions">
<h3><span class="section-number">1.5.6.1. </span>Statistical Distributions<a class="headerlink" href="#statistical-distributions" title="Link to this heading">¶</a></h3>
<p>Consider a random variable distributed according to the standard normal.
We draw a sample consisting of 100000 observations from the random variable.
The normalized histogram of the sample is an estimator of the random
variable’s probability density function (PDF):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># standard normal distribution</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>  <span class="c1"># &quot;random variate sample&quot;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;normalized histogram&#39;</span><span class="p">)</span>  
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PDF&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<div class="newline"></div><span class="go">&lt;matplotlib.legend.Legend object at ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_normal_distribution.html"><img alt="../../_images/sphx_glr_plot_normal_distribution_001.png" src="../../_images/sphx_glr_plot_normal_distribution_001.png" style="width: 448.0px; height: 336.0px;" /></a>
<aside class="sidebar">
<p class="sidebar-title"><strong>Distribution objects and frozen distributions</strong></p>
<p>Each of the 100+ <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> distribution families is represented by an
<em>object</em> with a <cite>__call__</cite> method. Here, we call the <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code>
object to specify its location and scale, and it returns a <em>frozen</em>
distribution: a particular element of a distribution family with all
parameters fixed. The frozen distribution object has methods to compute
essential functions of the particular distribution.</p>
</aside>
<p>Suppose we knew that the sample had been drawn from a distribution belonging
to the family of normal distributions, but we did not know the particular
distribution’s location (mean) and scale (standard deviation). We perform
maximum likelihood estimation of the unknown parameters using the
distribution family’s <code class="docutils literal notranslate"><span class="pre">fit</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span>
<div class="newline"></div><span class="go">0.0015767005...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">scale</span>
<div class="newline"></div><span class="go">0.9973396878...</span>
<div class="newline"></div></pre></div>
</div>
<p>Since we know the true parameters of the distribution from which the
sample was drawn, we are not surprised that these estimates are similar.</p>
<aside class="topic green">
<p class="topic-title">Exercise: Probability distributions</p>
<p>Generate 1000 random variates from a gamma distribution with a shape
parameter of 1. <em>Hint: the shape parameter is passed as the first
argument when freezing the distribution</em>. Plot the histogram of the
sample, and overlay the distribution’s PDF. Estimate the shape parameter
from the sample using the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Extra: the distributions have many useful methods. Explore them
using tab completion. Plot the cumulative density function of the
distribution, and compute the variance.</p>
</aside>
</section>
<section id="sample-statistics-and-hypothesis-tests">
<h3><span class="section-number">1.5.6.2. </span>Sample Statistics and Hypothesis Tests<a class="headerlink" href="#sample-statistics-and-hypothesis-tests" title="Link to this heading">¶</a></h3>
<p>The sample mean is an estimator of the mean of the distribution from which
the sample was drawn:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<div class="newline"></div><span class="go">0.001576700508...</span>
<div class="newline"></div></pre></div>
</div>
<p>NumPy includes some of the most fundamental sample statistics (e.g.
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.mean()</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.var.html#numpy.var" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.var()</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.percentile.html#numpy.percentile" title="(in NumPy v1.26)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.percentile()</span></code></a>);
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> includes many more. For instance, the geometric mean
is a common measure of central tendency for data that tends to be
distributed over many orders of magnitude.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gmean</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">sample</span><span class="p">)</span>
<div class="newline"></div><span class="go">1.0010934829...</span>
<div class="newline"></div></pre></div>
</div>
<p>SciPy also includes a variety of hypothesis tests that produce a
sample statistic and a p-value. For instance, suppose we wish to
test the null hypothesis that <code class="docutils literal notranslate"><span class="pre">sample</span></code> was drawn from a normal
distribution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">normaltest</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">statistic</span>
<div class="newline"></div><span class="go">5.20841759...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">pvalue</span>
<div class="newline"></div><span class="go">0.07396163283...</span>
<div class="newline"></div></pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">statistic</span></code> is a sample statistic that tends to be high for
samples that are drawn from non-normal distributions. <code class="docutils literal notranslate"><span class="pre">pvalue</span></code> is
the probability of observing such a high value of the statistic for
a sample that <em>has</em> been drawn from a normal distribution. If the
p-value is unusually small, this may be taken as evidence that
<code class="docutils literal notranslate"><span class="pre">sample</span></code> was <em>not</em> drawn from the normal distribution. Our statistic
and p-value are moderate, so the test is inconclusive.</p>
<p>There are many other features of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a>, including circular
statistics, quasi-Monte Carlo methods, and resampling methods.
For much more information, see the documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a>
and the advanced chapter <a class="reference internal" href="../../packages/statistics/index.html#statistics"><span class="std std-ref">statistics</span></a>.</p>
</section>
</section>
<section id="numerical-integration-scipy-integrate">
<h2><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">1.5.7. </span>Numerical integration: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a></a><a class="headerlink" href="#numerical-integration-scipy-integrate" title="Link to this heading">¶</a></h2>
<section id="quadrature">
<h3><span class="section-number">1.5.7.1. </span>Quadrature<a class="headerlink" href="#quadrature" title="Link to this heading">¶</a></h3>
<p>Suppose we wish to compute the definite integral
<img class="math" src="../../_images/math/f27e8b593a2860e854af06b677db21fe71ad1b39.png" alt="\int_0^{\pi / 2} \sin(t) dt"/> numerically. <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html#scipy.integrate.quad" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.quad()</span></code></a>
chooses one of several adaptive techniques depending on the parameters, and
is therefore the recommended first choice for integration of function of a single variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">integral</span><span class="p">,</span> <span class="n">error_estimate</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">integral</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># numerical result ~ analytical result</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">integral</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">error_estimate</span>  <span class="c1">#  actual error &lt; estimated error</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<p>Other functions for <em>numerical quadrature</em>, including integration of
multivariate functions and approximating integrals from samples, are available
in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a>.</p>
</section>
<section id="initial-value-problems">
<h3><span class="section-number">1.5.7.2. </span>Initial Value Problems<a class="headerlink" href="#initial-value-problems" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a> also features routines for integrating <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_differential_equation">Ordinary
Differential Equations (ODE)</a>.
For example, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#scipy.integrate.solve_ivp" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp()</span></code></a> integrates ODEs of the form:</p>
<div class="math">
<p><img src="../../_images/math/f4fc63a94d25c58234ceb9e3d3a6c454e6354ff6.png" alt="\frac{dy}{dt} = f(t, y(t))"/></p>
</div><p>from an initial time <img class="math" src="../../_images/math/ec0f4b5ec85f2c2005b5f78c12cf51c1cb2bb167.png" alt="t_0"/> and initial state <img class="math" src="../../_images/math/b40ea221d01ca85e9b16ce58d4adbea2c0d6c557.png" alt="y(t=t_0)=t_0"/> to a final
time <img class="math" src="../../_images/math/e245c5b74db9aaa49b6b2ee6f1081fa530928704.png" alt="t_f"/> or until an event occurs (e.g. a specified state is reached).</p>
<p>As an introduction, consider the initial value problem given by
<img class="math" src="../../_images/math/8737598bdeae2b88152d608e115c7e3b2836d8a8.png" alt="\frac{dy}{dt} = -2 y"/> and the initial condition <img class="math" src="../../_images/math/cb9e1aa485405b5c6a3d368c2ce5bf5d9acb355d.png" alt="y(t=0) = 1"/> on
the interval <img class="math" src="../../_images/math/a7a27b5fdb6fd24fb5b0a48cf278a4e27db22d65.png" alt="t = 0 \dots 4"/>. We begin by defining a callable that
computes <img class="math" src="../../_images/math/f7904bf68203597068eea5d66152901929a92c9b.png" alt="f(t, y(t))"/> given the current time and state.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span>
<div class="newline"></div></pre></div>
</div>
<p>Then, to compute <code class="docutils literal notranslate"><span class="pre">y</span></code> as a function of time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># time interval</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">t_span</span><span class="p">)</span>  <span class="c1"># times at which to evaluate `y`</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,]</span>  <span class="c1"># initial state</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t_span</span><span class="o">=</span><span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>and plot the result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">Text(0.5, ..., &#39;t&#39;)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">Text(..., 0.5, &#39;y&#39;)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Solution of Initial Value Problem&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">Text(0.5, 1.0, &#39;Solution of Initial Value Problem&#39;)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_solve_ivp_simple.html"><img alt="../../_images/sphx_glr_plot_solve_ivp_simple_001.png" class="align-right" src="../../_images/sphx_glr_plot_solve_ivp_simple_001.png" style="width: 280.0px; height: 210.0px;" /></a>
<p>Let us integrate a more complex ODE: a <a class="reference external" href="https://en.wikipedia.org/wiki/Harmonic_oscillator#Damped_harmonic_oscillator">damped
spring-mass oscillator</a>.
The position of a mass attached to a spring obeys the 2nd order ODE
<img class="math" src="../../_images/math/07bd7dfd4c2f783e6ad55aa36079dba4af1c5acd.png" alt="\ddot{y} + 2 \zeta \omega_0  \dot{y} + \omega_0^2 y = 0"/> with natural frequency
<img class="math" src="../../_images/math/59069ddff876d60c8faadbc0d920b910b4732fce.png" alt="\omega_0 = \sqrt{k/m}"/>, damping ratio <img class="math" src="../../_images/math/31c5faedfd9310a13b80d8cf25c15408be48a3f9.png" alt="\zeta = c/(2 m \omega_0)"/>,
spring constant <img class="math" src="../../_images/math/9630132210b904754c9ab272b61cb527d12263ca.png" alt="k"/>, mass <img class="math" src="../../_images/math/e9bc7da808d33a16a8347f27a519bd067186aa66.png" alt="m"/>, and damping coefficient <img class="math" src="../../_images/math/d520a12f1579170834c32ad5f656de081bbb36fe.png" alt="c"/>.</p>
<p>Before using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#scipy.integrate.solve_ivp" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp()</span></code></a>, the 2nd order ODE
needs to be transformed into a system of first-order ODEs. Note that</p>
<div class="math">
<p><img src="../../_images/math/c9a8525f4822ef9738d81df7ddbc7df0817ac5ab.png" alt="\frac{dy}{dt} = \dot{y}
\frac{d\dot{y}}{dt} = \ddot{y} = -(2 \zeta \omega_0  \dot{y} + \omega_0^2 y)"/></p>
</div><p>If we define <img class="math" src="../../_images/math/a812b27322592680185029fff413e9ce0b537308.png" alt="z = [z_0, z_1]"/> where <img class="math" src="../../_images/math/365377a79d216508d2a481a5236d5563ccf0269d.png" alt="z_0 = y"/> and <img class="math" src="../../_images/math/21e42768707533610171c3802536c765eb16ff24.png" alt="z_1 = \dot{y}"/>,
then the first order equation:</p>
<div class="math">
<p><img src="../../_images/math/cc75af13d98e1f7f45814e324d89f0607c926a52.png" alt="\frac{dz}{dt} =
\begin{bmatrix}
    \frac{dz_0}{dt} \\
    \frac{dz_1}{dt}
\end{bmatrix} =
\begin{bmatrix}
    z_1  \\
    -(2 \zeta \omega_0  z_1 + \omega_0^2 z_0)
\end{bmatrix}"/></p>
</div><p>is equivalent to the original second order equation.</p>
<p>We set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># kg</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># N/m</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># N s/m</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="n">m</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>and define the function that computes <img class="math" src="../../_images/math/128d1ab22661cc2971a7e4ca9020cee7b8dad692.png" alt="\dot{z} = f(t, z(t))"/>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_solve_ivp_damped_spring_mass.html"><img alt="../../_images/sphx_glr_plot_solve_ivp_damped_spring_mass_001.png" class="align-right" src="../../_images/sphx_glr_plot_solve_ivp_damped_spring_mass_001.png" style="width: 280.0px; height: 210.0px;" /></a>
<p>Integration of the system follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">t_span</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>                             <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">zeta</span><span class="p">,</span> <span class="n">omega</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;LSODA&#39;</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>With the option <cite>method=’LSODA’</cite>, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html#scipy.integrate.solve_ivp" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp()</span></code></a> uses the LSODA
(Livermore Solver for Ordinary Differential equations with Automatic method switching
for stiff and non-stiff problems). See the <a class="reference external" href="https://people.sc.fsu.edu/~jburkardt/f77_src/odepack/odepack.html">ODEPACK Fortran library</a> for more details.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong>Partial Differental Equations</strong></p>
<p>There is no Partial Differential Equations (PDE) solver in SciPy.
Some Python packages for solving PDE’s are available, such as <a class="reference external" href="https://www.ctcms.nist.gov/fipy/">fipy</a>
or <a class="reference external" href="https://sfepy.org/doc/">SfePy</a>.</p>
</div>
</section>
</section>
<section id="fast-fourier-transforms-scipy-fft">
<h2><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">1.5.8. </span>Fast Fourier transforms: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code></a></a><a class="headerlink" href="#fast-fourier-transforms-scipy-fft" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code></a> module computes fast Fourier transforms (FFTs)
and offers utilities to handle them. Some important functions are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fft.html#scipy.fft.fft" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fft()</span></code></a> to compute the FFT</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.fftfreq.html#scipy.fft.fftfreq" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fftfreq()</span></code></a> to generate the sampling frequencies</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.ifft.html#scipy.fft.ifft" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.ifft()</span></code></a> to compute the inverse FFT, from frequency
space to signal space</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>As an illustration, a (noisy) input signal (<code class="docutils literal notranslate"><span class="pre">sig</span></code>), and its FFT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sig_fft</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>  
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">freqs</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">time_step</span><span class="p">)</span>  
<div class="newline"></div></pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><a class="reference external" href="auto_examples/plot_fftpack.html"><img alt="signal_fig" src="../../_images/sphx_glr_plot_fftpack_001.png" style="width: 360.0px; height: 300.0px;" /></a></p></th>
<th class="head"><p><a class="reference external" href="auto_examples/plot_fftpack.html"><img alt="fft_fig" src="../../_images/sphx_glr_plot_fftpack_002.png" style="width: 360.0px; height: 300.0px;" /></a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Signal</strong></p></td>
<td><p><strong>FFT</strong></p></td>
</tr>
</tbody>
</table>
<p>As the signal comes from a real-valued function, the Fourier transform is
symmetric.</p>
<p>The peak signal frequency can be found with <code class="docutils literal notranslate"><span class="pre">freqs[power.argmax()]</span></code></p>
<a class="reference external image-reference" href="auto_examples/plot_fftpack.html"><img alt="../../_images/sphx_glr_plot_fftpack_003.png" class="align-right" src="../../_images/sphx_glr_plot_fftpack_003.png" style="width: 360.0px; height: 300.0px;" /></a>
<p>Setting the Fourier component above this frequency to zero and inverting
the FFT with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.fft.ifft.html#scipy.fft.ifft" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.ifft()</span></code></a>, gives a filtered signal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code of this example can be found <a class="reference internal" href="auto_examples/plot_fftpack.html#sphx-glr-intro-scipy-auto-examples-plot-fftpack-py"><span class="std std-ref">here</span></a></p>
</div>
<aside class="topic">
<p class="topic-title"><cite>numpy.fft</cite></p>
<p>NumPy also has an implementation of FFT (<a class="reference external" href="https://numpy.org/doc/stable/reference/routines.fft.html#module-numpy.fft" title="(in NumPy v1.26)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.fft</span></code></a>). However,
the SciPy one
should be preferred, as it uses more efficient underlying implementations.</p>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Fully worked examples:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Crude periodicity finding (<a class="reference internal" href="auto_examples/solutions/plot_periodicity_finder.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-periodicity-finder-py"><span class="std std-ref">link</span></a>)</p></th>
<th class="head"><p>Gaussian image blur (<a class="reference internal" href="auto_examples/solutions/plot_image_blur.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-image-blur-py"><span class="std std-ref">link</span></a>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="auto_examples/solutions/plot_periodicity_finder.html"><img alt="periodicity_finding" src="../../_images/sphx_glr_plot_periodicity_finder_001.png" style="width: 320.0px; height: 240.0px;" /></a></p></td>
<td><p><a class="reference external" href="auto_examples/solutions/plot_image_blur.html"><img alt="image_blur" src="../../_images/sphx_glr_plot_image_blur_002.png" style="width: 320.0px; height: 240.0px;" /></a></p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<aside class="topic green">
<p class="topic-title">Exercise: Denoise moon landing image</p>
<a class="reference internal image-reference" href="../../_images/moonlanding.png"><img alt="../../_images/moonlanding.png" src="../../_images/moonlanding.png" style="width: 441.0px; height: 331.79999999999995px;" /></a>
<ol class="arabic simple">
<li><p>Examine the provided image <a class="reference download internal" download="" href="../../_downloads/30c317481ebf471bf6b1470057bd3786/moonlanding.png"><code class="xref download docutils literal notranslate"><span class="pre">moonlanding.png</span></code></a>, which is heavily contaminated with periodic
noise. In this exercise, we aim to clean up the noise using the
Fast Fourier Transform.</p></li>
<li><p>Load the image using <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imread.html#matplotlib.pyplot.imread" title="(in Matplotlib v3.8.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imread()</span></code></a>.</p></li>
<li><p>Find and use the 2-D FFT function in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/fft.html#module-scipy.fft" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code></a>, and plot the
spectrum (Fourier transform of) the image. Do you have any trouble
visualising the spectrum? If so, why?</p></li>
<li><p>The spectrum consists of high and low frequency components. The noise is
contained in the high-frequency part of the spectrum, so set some of
those components to zero (use array slicing).</p></li>
<li><p>Apply the inverse Fourier transform to see the resulting image.</p></li>
</ol>
<p><a class="reference internal" href="auto_examples/solutions/plot_fft_image_denoise.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-fft-image-denoise-py"><span class="std std-ref">Solution</span></a></p>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="signal-processing-scipy-signal">
<h2><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">1.5.9. </span>Signal processing: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></a><a class="headerlink" href="#signal-processing-scipy-signal" title="Link to this heading">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a> is for typical signal processing: 1D,
regularly-sampled signals.</p>
</div>
<a class="reference external image-reference" href="auto_examples/plot_resample.html"><img alt="../../_images/sphx_glr_plot_resample_001.png" class="align-right" src="../../_images/sphx_glr_plot_resample_001.png" style="width: 325.0px; height: 260.0px;" /></a>
<p><strong>Resampling</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.resample.html#scipy.signal.resample" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.resample()</span></code></a>: resample a signal to <cite>n</cite>
points using FFT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x_resampled</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[::</span><span class="mi">4</span><span class="p">],</span> <span class="n">x_resampled</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Notice how on the side of the window the resampling is less accurate
and has a rippling effect.</p>
<p>This resampling is different from the <a class="reference internal" href="#intro-scipy-interpolate"><span class="std std-ref">interpolation</span></a> provided by <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/interpolate.html#module-scipy.interpolate" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a> as it
only applies to regularly sampled data.</p>
</div>
<a class="reference external image-reference" href="auto_examples/plot_detrend.html"><img alt="../../_images/sphx_glr_plot_detrend_001.png" class="align-right" src="../../_images/sphx_glr_plot_detrend_001.png" style="width: 325.0px; height: 260.0px;" /></a>
<p><strong>Detrending</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.detrend.html#scipy.signal.detrend" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.detrend()</span></code></a>: remove linear trend from signal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x_detrended</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_detrended</span><span class="p">)</span>
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><p><strong>Filtering</strong>:
For non-linear filtering, <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a> has filtering (median
filter <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.medfilt.html#scipy.signal.medfilt" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.medfilt()</span></code></a>, Wiener <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.wiener.html#scipy.signal.wiener" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.wiener()</span></code></a>),
but we will discuss this in the image section.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a> also has a full-blown set of tools for the design
of linear filter (finite and infinite response filters), but this is
out of the scope of this tutorial.</p>
</div>
<p><strong>Spectral analysis</strong>:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.spectrogram.html#scipy.signal.spectrogram" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.spectrogram()</span></code></a> compute a spectrogram –frequency
spectrums over consecutive time windows–, while
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.welch.html#scipy.signal.welch" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.signal.welch()</span></code></a> comptes a power spectrum density (PSD).</p>
<p><a class="reference external" href="auto_examples/plot_spectrogram.html"><img alt="chirp_fig" src="../../_images/sphx_glr_plot_spectrogram_001.png" style="width: 360.0px; height: 225.0px;" /></a> <a class="reference external" href="auto_examples/plot_spectrogram.html"><img alt="spectrogram_fig" src="../../_images/sphx_glr_plot_spectrogram_002.png" style="width: 225.0px; height: 180.0px;" /></a> <a class="reference external" href="auto_examples/plot_spectrogram.html"><img alt="psd_fig" src="../../_images/sphx_glr_plot_spectrogram_003.png" style="width: 225.0px; height: 180.0px;" /></a></p>
</section>
<section id="image-manipulation-scipy-ndimage">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">1.5.10. </span>Image manipulation: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></a><a class="headerlink" href="#image-manipulation-scipy-ndimage" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a> provides manipulation of n-dimensional arrays as
images.</p>
<section id="geometrical-transformations-on-images">
<h3><span class="section-number">1.5.10.1. </span>Geometrical transformations on images<a class="headerlink" href="#geometrical-transformations-on-images" title="Link to this heading">¶</a></h3>
<p>Changing orientation, resolution, ..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load an image</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shift, rotate and zoom it</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_face2</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">50</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">zoomed_face</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(1536, 2048)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_image_transform.html"><img alt="../../_images/sphx_glr_plot_image_transform_001.png" class="align-center" src="../../_images/sphx_glr_plot_image_transform_001.png" style="width: 1050.0px; height: 210.0px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">151</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;Axes: &gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">shifted_face</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">(-0.5, 1023.5, 767.5, -0.5)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># etc.</span>
<div class="newline"></div></pre></div>
</div>
</section>
<section id="image-filtering">
<h3><span class="section-number">1.5.10.2. </span>Image filtering<a class="headerlink" href="#image-filtering" title="Link to this heading">¶</a></h3>
<p>Generate a noisy face:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[:</span><span class="mi">512</span><span class="p">,</span> <span class="o">-</span><span class="mi">512</span><span class="p">:]</span>  <span class="c1"># crop out square on right</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_face</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">face</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy_face</span> <span class="o">+=</span> <span class="n">face</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Apply a variety of filters on it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">median_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">wiener_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">wiener</span><span class="p">(</span><span class="n">noisy_face</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_image_filters.html"><img alt="../../_images/sphx_glr_plot_image_filters_001.png" class="align-center" src="../../_images/sphx_glr_plot_image_filters_001.png" style="width: 840.0px; height: 244.99999999999997px;" /></a>
<p>Other filters in <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage.filters</span></code> and <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.html#module-scipy.signal" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a>
can be applied to images.</p>
<aside class="topic green">
<p class="topic-title">Exercise</p>
<blockquote>
<div><p>Compare histograms for the different filtered images.</p>
</div></blockquote>
</aside>
</section>
<section id="mathematical-morphology">
<h3><span class="section-number">1.5.10.3. </span>Mathematical morphology<a class="headerlink" href="#mathematical-morphology" title="Link to this heading">¶</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">Mathematical morphology</a> stems from set
theory. It characterizes and transforms geometrical structures. Binary
(black and white) images, in particular, can be transformed using this
theory: the sets to be transformed are the sets of neighboring
non-zero-valued pixels. The theory was also extended to gray-valued
images.</p>
</div>
<img alt="../../_images/morpho_mat1.png" class="align-center" src="../../_images/morpho_mat1.png" />
<p>Mathematical-morphology operations use a <em>structuring element</em>
in order to modify geometrical structures.</p>
<p>Let us first generate a structuring element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span>
<div class="newline"></div><span class="go">array([[False, True, False],</span>
<div class="newline"></div><span class="go">       [...True, True, True],</span>
<div class="newline"></div><span class="go">       [False, True, False]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 1, 0],</span>
<div class="newline"></div><span class="go">       [1, 1, 1],</span>
<div class="newline"></div><span class="go">       [0, 1, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<ul>
<li><p><strong>Erosion</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_erosion.html#scipy.ndimage.binary_erosion" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_erosion()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Erosion removes objects smaller than the structure</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p><strong>Dilation</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_dilation.html#scipy.ndimage.binary_dilation" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_dilation()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  1.,  1.,  1.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p><strong>Opening</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_opening.html#scipy.ndimage.binary_opening" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_opening()</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 1]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening removes small objects</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening can also smooth corners</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p><strong>Closing:</strong> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.binary_closing.html#scipy.ndimage.binary_closing" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.binary_closing()</span></code></a></p></li>
</ul>
<aside class="topic green">
<p class="topic-title">Exercise</p>
<blockquote>
<div><p>Check that opening amounts to eroding, then dilating.</p>
</div></blockquote>
</aside>
<p>An opening operation removes small structures, while a closing operation
fills small holes. Such operations can therefore be used to “clean” an
image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">a</span><span class="o">&gt;=</span><span class="mf">0.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">opened_mask</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">closed_mask</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">opened_mask</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_mathematical_morpho.html"><img alt="../../_images/sphx_glr_plot_mathematical_morpho_001.png" class="align-center" src="../../_images/sphx_glr_plot_mathematical_morpho_001.png" style="width: 840.0px; height: 244.99999999999997px;" /></a>
<aside class="topic green">
<p class="topic-title">Exercise</p>
<blockquote>
<div><p>Check that the area of the reconstructed square is smaller
than the area of the initial square. (The opposite would occur if the
closing step was performed <em>before</em> the opening).</p>
</div></blockquote>
</aside>
<p>For <em>gray-valued</em> images, eroding (resp. dilating) amounts to replacing
a pixel by the minimal (resp. maximal) value among pixels covered by the
structuring element centered on the pixel of interest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 1, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 2, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 3, 2, 2, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
</section>
<section id="connected-components-and-measurements-on-images">
<h3><span class="section-number">1.5.10.4. </span>Connected components and measurements on images<a class="headerlink" href="#connected-components-and-measurements-on-images" title="Link to this heading">¶</a></h3>
<p>Let us first generate a nice synthetic binary image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mf">50.</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">&gt;</span> <span class="mi">1</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_connect_measurements.html"><img alt="../../_images/sphx_glr_plot_connect_measurements_001.png" class="align-center" src="../../_images/sphx_glr_plot_connect_measurements_001.png" style="width: 420.0px; height: 210.0px;" /></a>
<a class="reference external image-reference" href="auto_examples/plot_connect_measurements.html"><img alt="../../_images/sphx_glr_plot_connect_measurements_002.png" class="align-right" src="../../_images/sphx_glr_plot_connect_measurements_002.png" style="width: 210.0px; height: 210.0px;" /></a>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.label.html#scipy.ndimage.label" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.ndimage.label()</span></code></a> assigns a different label to each connected
component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">nb</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">nb</span>
<div class="newline"></div><span class="go">8</span>
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><p>Now compute measurements on each connected component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span>   <span class="c1"># The number of pixels in each connected component</span>
<div class="newline"></div><span class="go">array([190.,   45.,  424.,  278.,  459.,  190.,  549.,  424.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">maxima</span>  <span class="c1"># The maximum signal in each connected component</span>
<div class="newline"></div><span class="go">array([ 1.80238238,   1.13527605,   5.51954079,   2.49611818, 6.71673619,</span>
<div class="newline"></div><span class="go">        1.80238238,  16.76547217,   5.51954079])</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_connect_measurements.html"><img alt="../../_images/sphx_glr_plot_connect_measurements_003.png" class="align-right" src="../../_images/sphx_glr_plot_connect_measurements_003.png" style="width: 210.0px; height: 210.0px;" /></a>
<p>Extract the 4th connected component, and crop the array around it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<div class="newline"></div><span class="go">(slice(30, 48, None), slice(30, 48, None))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sl</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">labels</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">sl</span><span class="p">])</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>See the summary exercise on <a class="reference internal" href="summary-exercises/image-processing.html#summary-exercise-image-processing"><span class="std std-ref">Image processing application: counting bubbles and unmolten grains</span></a> for a more
advanced example.</p>
</section>
</section>
<section id="summary-exercises-on-scientific-computing">
<h2><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">1.5.11. </span>Summary exercises on scientific computing</a><a class="headerlink" href="#summary-exercises-on-scientific-computing" title="Link to this heading">¶</a></h2>
<p>The summary exercises use mainly NumPy, SciPy and Matplotlib. They provide some
real-life examples of scientific computing with Python. Now that the basics of
working with NumPy and SciPy have been introduced, the interested user is
invited to try these exercises.</p>
<p><strong>Exercises:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/stats-interpolate.html">1.5.11.1. Maximum wind speed prediction at the Sprogø station</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/optimize-fit.html">1.5.11.2. Non linear least squares curve fitting: application to point extraction in topographical lidar data</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/image-processing.html">1.5.11.3. Image processing application: counting bubbles and unmolten grains</a></li>
</ul>
</div>
<p><strong>Proposed solutions:</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary-exercises/answers_image_processing.html">1.5.11.4. Example of solution for the image processing exercise: unmolten grains in glass</a></li>
</ul>
</div>
</section>
<section id="full-code-examples-for-the-scipy-chapter">
<h2><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">1.5.12. </span>Full code examples for the SciPy chapter</a><a class="headerlink" href="#full-code-examples-for-the-scipy-chapter" title="Link to this heading">¶</a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Demos various methods to find the minimum of a function."><img alt="" src="../../_images/sphx_glr_plot_optimize_example1_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_optimize_example1.html#sphx-glr-intro-scipy-auto-examples-plot-optimize-example1-py"><span class="std std-ref">Finding the minimum of a smooth function</span></a></p>
  <div class="sphx-glr-thumbnail-title">Finding the minimum of a smooth function</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="scipy.signal.resample uses FFT to resample a 1D signal."><img alt="" src="../../_images/sphx_glr_plot_resample_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_resample.html#sphx-glr-intro-scipy-auto-examples-plot-resample-py"><span class="std std-ref">Resample a signal with scipy.signal.resample</span></a></p>
  <div class="sphx-glr-thumbnail-title">Resample a signal with scipy.signal.resample</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="scipy.signal.detrend removes a linear trend."><img alt="" src="../../_images/sphx_glr_plot_detrend_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_detrend.html#sphx-glr-intro-scipy-auto-examples-plot-detrend-py"><span class="std std-ref">Detrending a signal</span></a></p>
  <div class="sphx-glr-thumbnail-title">Detrending a signal</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Solve the ODE dy/dt = -2y between t = 0..4, with the initial condition y(t=0) = 1."><img alt="" src="../../_images/sphx_glr_plot_solve_ivp_simple_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_solve_ivp_simple.html#sphx-glr-intro-scipy-auto-examples-plot-solve-ivp-simple-py"><span class="std std-ref">Integrating a simple ODE</span></a></p>
  <div class="sphx-glr-thumbnail-title">Integrating a simple ODE</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Explore the normal distribution: a histogram built from samples and the PDF (probability densit..."><img alt="" src="../../_images/sphx_glr_plot_normal_distribution_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_normal_distribution.html#sphx-glr-intro-scipy-auto-examples-plot-normal-distribution-py"><span class="std std-ref">Normal distribution: histogram and PDF</span></a></p>
  <div class="sphx-glr-thumbnail-title">Normal distribution: histogram and PDF</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Integrate the Damped spring-mass oscillator"><img alt="" src="../../_images/sphx_glr_plot_solve_ivp_damped_spring_mass_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_solve_ivp_damped_spring_mass.html#sphx-glr-intro-scipy-auto-examples-plot-solve-ivp-damped-spring-mass-py"><span class="std std-ref">Integrate the Damped spring-mass oscillator</span></a></p>
  <div class="sphx-glr-thumbnail-title">Integrate the Damped spring-mass oscillator</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Comparing 2 sets of samples from Gaussians"><img alt="" src="../../_images/sphx_glr_plot_t_test_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_t_test.html#sphx-glr-intro-scipy-auto-examples-plot-t-test-py"><span class="std std-ref">Comparing 2 sets of samples from Gaussians</span></a></p>
  <div class="sphx-glr-thumbnail-title">Comparing 2 sets of samples from Gaussians</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Demos a simple curve fitting"><img alt="" src="../../_images/sphx_glr_plot_curve_fit_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_curve_fit.html#sphx-glr-intro-scipy-auto-examples-plot-curve-fit-py"><span class="std std-ref">Curve fitting</span></a></p>
  <div class="sphx-glr-thumbnail-title">Curve fitting</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Demo spectrogram and power spectral density on a frequency chirp."><img alt="" src="../../_images/sphx_glr_plot_spectrogram_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_spectrogram.html#sphx-glr-intro-scipy-auto-examples-plot-spectrogram-py"><span class="std std-ref">Spectrogram, power spectral density</span></a></p>
  <div class="sphx-glr-thumbnail-title">Spectrogram, power spectral density</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="A basic demo of binary opening and closing."><img alt="" src="../../_images/sphx_glr_plot_mathematical_morpho_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_mathematical_morpho.html#sphx-glr-intro-scipy-auto-examples-plot-mathematical-morpho-py"><span class="std std-ref">Demo mathematical morphology</span></a></p>
  <div class="sphx-glr-thumbnail-title">Demo mathematical morphology</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="A demo of 1D interpolation"><img alt="" src="../../_images/sphx_glr_plot_interpolation_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_interpolation.html#sphx-glr-intro-scipy-auto-examples-plot-interpolation-py"><span class="std std-ref">A demo of 1D interpolation</span></a></p>
  <div class="sphx-glr-thumbnail-title">A demo of 1D interpolation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Demo geometrical transformations of images."><img alt="" src="../../_images/sphx_glr_plot_image_transform_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_image_transform.html#sphx-glr-intro-scipy-auto-examples-plot-image-transform-py"><span class="std std-ref">Plot geometrical transformations on images</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plot geometrical transformations on images</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Extracting and labeling connected components in a 2D array"><img alt="" src="../../_images/sphx_glr_plot_connect_measurements_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_connect_measurements.html#sphx-glr-intro-scipy-auto-examples-plot-connect-measurements-py"><span class="std std-ref">Demo connected components</span></a></p>
  <div class="sphx-glr-thumbnail-title">Demo connected components</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Demos finding minima and roots of a function."><img alt="" src="../../_images/sphx_glr_plot_optimize_example2_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_optimize_example2.html#sphx-glr-intro-scipy-auto-examples-plot-optimize-example2-py"><span class="std std-ref">Minima and roots of a function</span></a></p>
  <div class="sphx-glr-thumbnail-title">Minima and roots of a function</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Demo filtering for denoising of images."><img alt="" src="../../_images/sphx_glr_plot_image_filters_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_image_filters.html#sphx-glr-intro-scipy-auto-examples-plot-image-filters-py"><span class="std std-ref">Plot filtering on images</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plot filtering on images</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optimization of a two-parameter function"><img alt="" src="../../_images/sphx_glr_plot_2d_minimization_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_2d_minimization.html#sphx-glr-intro-scipy-auto-examples-plot-2d-minimization-py"><span class="std std-ref">Optimization of a two-parameter function</span></a></p>
  <div class="sphx-glr-thumbnail-title">Optimization of a two-parameter function</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Plot the power of the FFT of a signal and inverse FFT back to reconstruct a signal."><img alt="" src="../../_images/sphx_glr_plot_fftpack_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_fftpack.html#sphx-glr-intro-scipy-auto-examples-plot-fftpack-py"><span class="std std-ref">Plotting and manipulating FFTs for filtering</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plotting and manipulating FFTs for filtering</div>
</div></div><div class="toctree-wrapper compound">
</div>
<section id="solutions-of-the-exercises-for-scipy">
<h3><span class="section-number">1.5.12.18. </span>Solutions of the exercises for SciPy<a class="headerlink" href="#solutions-of-the-exercises-for-scipy" title="Link to this heading">¶</a></h3>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Discover the periods in evolution of animal populations (../../../../data/populations.txt)"><img alt="" src="../../_images/sphx_glr_plot_periodicity_finder_thumb.png" />
<p><a class="reference internal" href="auto_examples/solutions/plot_periodicity_finder.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-periodicity-finder-py"><span class="std std-ref">Crude periodicity finding</span></a></p>
  <div class="sphx-glr-thumbnail-title">Crude periodicity finding</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="We have the min and max temperatures in Alaska for each months of the year. We would like to fi..."><img alt="" src="../../_images/sphx_glr_plot_curvefit_temperature_data_thumb.png" />
<p><a class="reference internal" href="auto_examples/solutions/plot_curvefit_temperature_data.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-curvefit-temperature-data-py"><span class="std std-ref">Curve fitting: temperature as a function of month of the year</span></a></p>
  <div class="sphx-glr-thumbnail-title">Curve fitting: temperature as a function of month of the year</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Blur an an image (../../../../data/elephant.png) using a Gaussian kernel."><img alt="" src="../../_images/sphx_glr_plot_image_blur_thumb.png" />
<p><a class="reference internal" href="auto_examples/solutions/plot_image_blur.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-image-blur-py"><span class="std std-ref">Simple image blur by convolution with a Gaussian kernel</span></a></p>
  <div class="sphx-glr-thumbnail-title">Simple image blur by convolution with a Gaussian kernel</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Denoise an image (../../../../data/moonlanding.png) by implementing a blur with an FFT."><img alt="" src="../../_images/sphx_glr_plot_fft_image_denoise_thumb.png" />
<p><a class="reference internal" href="auto_examples/solutions/plot_fft_image_denoise.html#sphx-glr-intro-scipy-auto-examples-solutions-plot-fft-image-denoise-py"><span class="std std-ref">Image denoising by FFT</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image denoising by FFT</div>
</div></div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-footer sphx-glr-footer-gallery docutils container">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/89e050515d3da6313decb5b1b0d5787d/auto_examples_python.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">auto_examples_python.zip</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8da74510b6533b5cd0d7bcdff74bda7f/auto_examples_jupyter.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Jupyter</span> <span class="pre">notebooks:</span> <span class="pre">auto_examples_jupyter.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong>References to go further</strong></p>
<ul class="simple">
<li><p>Some chapters of the <a class="reference external" href="advanced_topics_part">advanced</a> and the
<a class="reference external" href="applications_part">packages and applications</a> parts of the SciPy
lectures</p></li>
<li><p>The <a class="reference external" href="https://scipy-cookbook.readthedocs.io">SciPy cookbook</a></p></li>
</ul>
</div>
<div class="toctree-wrapper compound">
</div>
<p><div style="clear: both"></div></p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">1.5. SciPy : high-level scientific computing</a><ul>
<li><a class="reference internal" href="#file-input-output-scipy-io">1.5.1. File input/output: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io</span></code></a></li>
<li><a class="reference internal" href="#special-functions-scipy-special">1.5.2. Special functions: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.special</span></code></a></li>
<li><a class="reference internal" href="#linear-algebra-operations-scipy-linalg">1.5.3. Linear algebra operations: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a></li>
<li><a class="reference internal" href="#interpolation-scipy-interpolate">1.5.4. Interpolation: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.interpolate</span></code></a></li>
<li><a class="reference internal" href="#optimization-and-fit-scipy-optimize">1.5.5. Optimization and fit: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.optimize</span></code></a><ul>
<li><a class="reference internal" href="#root-finding">1.5.5.1. Root Finding</a></li>
<li><a class="reference internal" href="#curve-fitting">1.5.5.2. Curve fitting</a></li>
<li><a class="reference internal" href="#optimization">1.5.5.3. Optimization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#statistics-and-random-numbers-scipy-stats">1.5.6. Statistics and random numbers: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a><ul>
<li><a class="reference internal" href="#statistical-distributions">1.5.6.1. Statistical Distributions</a></li>
<li><a class="reference internal" href="#sample-statistics-and-hypothesis-tests">1.5.6.2. Sample Statistics and Hypothesis Tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numerical-integration-scipy-integrate">1.5.7. Numerical integration: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.integrate</span></code></a><ul>
<li><a class="reference internal" href="#quadrature">1.5.7.1. Quadrature</a></li>
<li><a class="reference internal" href="#initial-value-problems">1.5.7.2. Initial Value Problems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fast-fourier-transforms-scipy-fft">1.5.8. Fast Fourier transforms: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.fft</span></code></a></li>
<li><a class="reference internal" href="#signal-processing-scipy-signal">1.5.9. Signal processing: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.signal</span></code></a></li>
<li><a class="reference internal" href="#image-manipulation-scipy-ndimage">1.5.10. Image manipulation: <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a><ul>
<li><a class="reference internal" href="#geometrical-transformations-on-images">1.5.10.1. Geometrical transformations on images</a></li>
<li><a class="reference internal" href="#image-filtering">1.5.10.2. Image filtering</a></li>
<li><a class="reference internal" href="#mathematical-morphology">1.5.10.3. Mathematical morphology</a></li>
<li><a class="reference internal" href="#connected-components-and-measurements-on-images">1.5.10.4. Connected components and measurements on images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#summary-exercises-on-scientific-computing">1.5.11. Summary exercises on scientific computing</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#full-code-examples-for-the-scipy-chapter">1.5.12. Full code examples for the SciPy chapter</a><ul>
<li><a class="reference internal" href="#solutions-of-the-exercises-for-scipy">1.5.12.18. Solutions of the exercises for SciPy</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../matplotlib/auto_examples/pretty_plots/plot_text_ext.html"
                          title="previous chapter">Text printing decorated</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="summary-exercises/stats-interpolate.html"
                          title="next chapter"><span class="section-number">1.5.11.1. </span>Maximum wind speed prediction at the Sprogø station</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/intro/scipy/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="summary-exercises/stats-interpolate.html" title="1.5.11.1. Maximum wind speed prediction at the Sprogø station"
             >next</a></li>
        <li class="right" >
          <a href="../matplotlib/auto_examples/pretty_plots/plot_text_ext.html" title="Text printing decorated"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scientific Python Lectures</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">1. </span>Getting started with Python for science</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">1.5. </span>SciPy : high-level scientific computing</a></li>
     
    <!-- Insert a tip toggle in the navigation bar -->
        <li class="left">
        <!-- On click, expand all tips -->
        <!--
        <a>
            <img src="../../_static/plus.png"
                 alt="Expand tips" style="padding: 1ex;"/>
            <span class="hiddenlink">Collapse document to compact view</span>
        </a>
        -->
        </li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scientific-python-lectures/edit/main/intro/scipy/index.rst">Edit
      <span class="tooltip">
        Improve this page:<br/>Edit it on Github.
      </span>
    </a>
    </li>
    
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>