<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.6. Image manipulation and processing using NumPy and SciPy &#8212; Scientific Python Lectures</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=c29d3f28" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss@3.0.0/build/base-min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/foldable_toc.css?v=38a22cee" />
    <script src="../../_static/documentation_options.js?v=3d051f0c"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=0729d509"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="../../_static/scroll_highlight_toc.js?v=cbac5d29"></script>
    <script src="../../_static/foldable_toc.js?v=d65ca516"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.6.8.1. Displaying a Raccoon Face" href="auto_examples/plot_face.html" />
    <link rel="prev" title="2.5.4. Other Interesting Packages" href="../scipy_sparse/other_packages.html" />
 

<script defer data-domain="lectures.scientific-python.org" src="https://views.scientific-python.org/js/script.js"></script>

  </head><body>
    <!-- Use the header to add javascript -->
    

    <script type="text/javascript">
     // Function to toggle tip div
     function toggle_tip_div(obj) {
       $(obj).find("p.summary").remove();

       var content = $(obj).text();
       var html = $(obj).html();

       if ($(obj).hasClass("collapsed")) {
         // Expand
         $(obj).html('<p class="summary"><img src="../../_static/minus.png"></p>' + html);
       } else {
         // Collapse
         if(content.length > 50) {
           content = content.substr(0, 47);
         }
         $(obj).html('<p class="summary"><img src="../../_static/plus.png">' + content + '...</p>' + html);
       }

       $(obj).toggleClass("collapsed");
     }

     $(document).ready(function () {
       $(".tip").each(function() {
         $(this).find("p.admonition-title").remove();
       });
       // Collapse all tips and add plus sign
       $(".tip").each(function() { toggle_tip_div($(this)); });

       $(".tip")
         .click(function(event){
           // Change state of the global button
           $('div.related li.transparent').removeClass('transparent');
           toggle_tip_div($(this));
           if (event.target.tagName.toLowerCase() != "a") {
             return true; //Makes links clickable
           }
         });
     });
    </script>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="auto_examples/plot_face.html" title="2.6.8.1. Displaying a Raccoon Face"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../scipy_sparse/other_packages.html" title="2.5.4. Other Interesting Packages"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scientific Python Lectures</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U"><span class="section-number">2. </span>Advanced topics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.6. </span>Image manipulation and processing using NumPy and SciPy</a></li>
     
    <!-- Insert a tip toggle in the navigation bar -->
        <li class="left">
        <!-- On click, expand all tips -->
        <!--
        <a>
            <img src="../../_static/plus.png"
                 alt="Expand tips" style="padding: 1ex;"/>
            <span class="hiddenlink">Collapse document to compact view</span>
        </a>
        -->
        </li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scientific-python-lectures/edit/main/advanced/image_processing/index.rst">Edit
      <span class="tooltip">
        Improve this page:<br/>Edit it on Github.
      </span>
    </a>
    </li>
    
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="image-manipulation-and-processing-using-numpy-and-scipy">
<span id="basic-image"></span><h1><span class="section-number">2.6. </span>Image manipulation and processing using NumPy and SciPy<a class="headerlink" href="#image-manipulation-and-processing-using-numpy-and-scipy" title="Link to this heading">¶</a></h1>
<p><strong>Authors</strong>: <em>Emmanuelle Gouillart, Gaël Varoquaux</em></p>
<p>This section addresses basic image manipulation and processing using the
core scientific modules NumPy and SciPy. Some of the operations covered
by this tutorial may be useful for other kinds of multidimensional array
processing than image processing. In particular, the submodule
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a> provides functions operating on n-dimensional NumPy
arrays.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more advanced image processing and image-specific routines, see the
tutorial <a class="reference internal" href="../../packages/scikit-image/index.html#scikit-image"><span class="std std-ref">scikit-image: image processing</span></a>, dedicated to the <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.html#module-skimage" title="(in skimage v0.22.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">skimage</span></code></a> module.</p>
</div>
<aside class="topic">
<p class="topic-title">Image = 2-D numerical array</p>
<p>(or 3-D: CT, MRI, 2D + time; 4-D, …)</p>
<p>Here, <strong>image == NumPy array</strong> <code class="docutils literal notranslate"><span class="pre">np.array</span></code></p>
</aside>
<p><strong>Tools used in this tutorial</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code>: basic array manipulation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy</span></code>: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage</span></code> submodule dedicated to image processing
(n-dimensional images). See the <a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/ndimage.html">documentation</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div></pre></div>
</div>
</li>
</ul>
<p><strong>Common tasks in image processing</strong>:</p>
<ul class="simple">
<li><p>Input/Output, displaying images</p></li>
<li><p>Basic manipulations: cropping, flipping, rotating, …</p></li>
<li><p>Image filtering: denoising, sharpening</p></li>
<li><p>Image segmentation: labeling pixels corresponding to different objects</p></li>
<li><p>Classification</p></li>
<li><p>Feature extraction</p></li>
<li><p>Registration</p></li>
<li><p>…</p></li>
</ul>
<nav class="contents local" id="chapters-contents">
<p class="topic-title">Chapters contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#opening-and-writing-to-image-files" id="id1">Opening and writing to image files</a></p></li>
<li><p><a class="reference internal" href="#displaying-images" id="id2">Displaying images</a></p></li>
<li><p><a class="reference internal" href="#basic-manipulations" id="id3">Basic manipulations</a></p>
<ul>
<li><p><a class="reference internal" href="#statistical-information" id="id4">Statistical information</a></p></li>
<li><p><a class="reference internal" href="#geometrical-transformations" id="id5">Geometrical transformations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#image-filtering" id="id6">Image filtering</a></p>
<ul>
<li><p><a class="reference internal" href="#blurring-smoothing" id="id7">Blurring/smoothing</a></p></li>
<li><p><a class="reference internal" href="#sharpening" id="id8">Sharpening</a></p></li>
<li><p><a class="reference internal" href="#denoising" id="id9">Denoising</a></p></li>
<li><p><a class="reference internal" href="#mathematical-morphology" id="id10">Mathematical morphology</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#feature-extraction" id="id11">Feature extraction</a></p>
<ul>
<li><p><a class="reference internal" href="#edge-detection" id="id12">Edge detection</a></p></li>
<li><p><a class="reference internal" href="#segmentation" id="id13">Segmentation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#measuring-objects-properties-scipy-ndimage-measurements" id="id14">Measuring objects properties: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.measurements</span></code></a></p></li>
<li><p><a class="reference internal" href="#full-code-examples" id="id15">Full code examples</a></p></li>
<li><p><a class="reference internal" href="#examples-for-the-image-processing-chapter" id="id16">Examples for the image processing chapter</a></p></li>
</ul>
</nav>
<section id="opening-and-writing-to-image-files">
<h2><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">2.6.1. </span>Opening and writing to image files</a><a class="headerlink" href="#opening-and-writing-to-image-files" title="Link to this heading">¶</a></h2>
<p>Writing an array to a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div><span class="kn">import</span> <span class="nn">imageio.v3</span> <span class="k">as</span> <span class="nn">iio</span>
<div class="newline"></div>
<div class="newline"></div><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">()</span>
<div class="newline"></div><span class="n">iio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s2">&quot;face.png&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>  <span class="c1"># uses the Image module (PIL)</span>
<div class="newline"></div>
<div class="newline"></div><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div>
<div class="newline"></div><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<div class="newline"></div><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/face.png"><img alt="../../_images/face.png" class="align-center" src="../../_images/face.png" style="width: 512.0px; height: 384.0px;" /></a>
<p>Creating a NumPy array from an image file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">imageio.v3</span> <span class="k">as</span> <span class="nn">iio</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">iio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;face.png&#39;</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>  <span class="c1"># First we need to create the PNG file</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">iio</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;face.png&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;class &#39;numpy.ndarray&#39;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">face</span><span class="o">.</span><span class="n">dtype</span>
<div class="newline"></div><span class="go">((768, 1024, 3), dtype(&#39;uint8&#39;))</span>
<div class="newline"></div></pre></div>
</div>
<p>dtype is uint8 for 8-bit images (0-255)</p>
<p>Opening raw files (camera, 3-D images)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="s1">&#39;face.raw&#39;</span><span class="p">)</span> <span class="c1"># Create raw file</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face_from_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="s1">&#39;face.raw&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face_from_raw</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(2359296,)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face_from_raw</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">768</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Need to know the shape and dtype of the image (how to separate data
bytes).</p>
<p>For large data, use <code class="docutils literal notranslate"><span class="pre">np.memmap</span></code> for memory mapping:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face_memmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s1">&#39;face.raw&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">768</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<p>(data are read from the file, and not loaded into memory)</p>
<p>Working on a list of image files</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">im</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">iio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;random_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">filelist</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;random*.png&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">filelist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
</section>
<section id="displaying-images">
<h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">2.6.2. </span>Displaying images</a><a class="headerlink" href="#displaying-images" title="Link to this heading">¶</a></h2>
<p>Use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and <code class="docutils literal notranslate"><span class="pre">imshow</span></code> to display an image inside a
<code class="docutils literal notranslate"><span class="pre">matplotlib</span> <span class="pre">figure</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># retrieve a grayscale image</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>Increase contrast by setting min and max values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove axes and ticks</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">(-0.5, 1023.5, 767.5, -0.5)</span>
<div class="newline"></div></pre></div>
</div>
<p>Draw contour lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
<div class="newline"></div><span class="go">&lt;matplotlib.contour.QuadContourSet ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_display_face.html"><img alt="../../_images/sphx_glr_plot_display_face_001.png" src="../../_images/sphx_glr_plot_display_face_001.png" style="width: 800.0px; height: 288.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_display_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-display-face-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>For smooth intensity variations, use <code class="docutils literal notranslate"><span class="pre">interpolation='bilinear'</span></code>. For fine inspection of intensity variations, use
<code class="docutils literal notranslate"><span class="pre">interpolation='nearest'</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">320</span><span class="p">:</span><span class="mi">340</span><span class="p">,</span> <span class="mi">510</span><span class="p">:</span><span class="mi">530</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">320</span><span class="p">:</span><span class="mi">340</span><span class="p">,</span> <span class="mi">510</span><span class="p">:</span><span class="mi">530</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_interpolation_face.html"><img alt="../../_images/sphx_glr_plot_interpolation_face_001.png" src="../../_images/sphx_glr_plot_interpolation_face_001.png" style="width: 640.0px; height: 320.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_interpolation_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-interpolation-face-py"><span class="std std-ref">Python source code</span></a>]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>More interpolation methods are in  <a class="reference external" href="https://matplotlib.org/examples/images_contours_and_fields/interpolation_methods.html">Matplotlib’s examples</a>.</p>
</div>
</section>
<section id="basic-manipulations">
<h2><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">2.6.3. </span>Basic manipulations</a><a class="headerlink" href="#basic-manipulations" title="Link to this heading">¶</a></h2>
<p>Images are arrays: use the whole <code class="docutils literal notranslate"><span class="pre">numpy</span></code> machinery.</p>
<a class="reference internal image-reference" href="../../_images/axis_convention.png"><img alt="../../_images/axis_convention.png" class="align-center" src="../../_images/axis_convention.png" style="width: 432.25px; height: 221.65px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<div class="newline"></div><span class="go">127</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Slicing</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[141, 153, 145],</span>
<div class="newline"></div><span class="go">       [133, 134, 125],</span>
<div class="newline"></div><span class="go">       [ 96,  92,  94]], dtype=uint8)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">120</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">ly</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="n">lx</span> <span class="o">*</span> <span class="n">ly</span> <span class="o">/</span> <span class="mi">4</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Masks</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fancy indexing</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">400</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">255</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_numpy_array.html"><img alt="../../_images/sphx_glr_plot_numpy_array_001.png" src="../../_images/sphx_glr_plot_numpy_array_001.png" style="width: 300.0px; height: 300.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_numpy_array.html#sphx-glr-advanced-image-processing-auto-examples-plot-numpy-array-py"><span class="std std-ref">Python source code</span></a>]</p>
<section id="statistical-information">
<h3><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">2.6.3.1. </span>Statistical information</a><a class="headerlink" href="#statistical-information" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">113.48026784261067</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">face</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<div class="newline"></div><span class="go">(250, 0)</span>
<div class="newline"></div></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.histogram</span></code></p>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<ul class="simple">
<li><p>Open as an array the <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code> logo
(<a class="reference external" href="https://scikit-image.org/_static/img/logo.png">https://scikit-image.org/_static/img/logo.png</a>), or an
image that you have on your computer.</p></li>
<li><p>Crop a meaningful part of the image, for example the python circle
in the logo.</p></li>
<li><p>Display the image array using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. Change the
interpolation method and zoom to see the difference.</p></li>
<li><p>Transform your image to greyscale</p></li>
<li><p>Increase the contrast of the image by changing its minimum and
maximum values. <strong>Optional</strong>: use <code class="docutils literal notranslate"><span class="pre">scipy.stats.scoreatpercentile</span></code>
(read the docstring!) to saturate 5% of the darkest pixels and 5%
of the lightest pixels.</p></li>
<li><p>Save the array to two different file formats (png, jpg, tiff)</p></li>
</ul>
<img alt="../../_images/scikit_image_logo.png" class="align-center" src="../../_images/scikit_image_logo.png" />
</aside>
</section>
<section id="geometrical-transformations">
<h3><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">2.6.3.2. </span>Geometrical transformations</a><a class="headerlink" href="#geometrical-transformations" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Cropping</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">crop_face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="n">lx</span> <span class="o">//</span> <span class="mi">4</span><span class="p">:</span> <span class="o">-</span> <span class="n">lx</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ly</span> <span class="o">//</span> <span class="mi">4</span><span class="p">:</span> <span class="o">-</span> <span class="n">ly</span> <span class="o">//</span> <span class="mi">4</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># up &lt;-&gt; down flip</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">flip_ud_face</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># rotation</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rotate_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rotate_face_noreshape</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_geom_face.html"><img alt="../../_images/sphx_glr_plot_geom_face_001.png" src="../../_images/sphx_glr_plot_geom_face_001.png" style="width: 812.5px; height: 162.5px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_geom_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-geom-face-py"><span class="std std-ref">Python source code</span></a>]</p>
</section>
</section>
<section id="image-filtering">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">2.6.4. </span>Image filtering</a><a class="headerlink" href="#image-filtering" title="Link to this heading">¶</a></h2>
<p><strong>Local filters</strong>: replace the value of pixels by a function of the values of
neighboring pixels.</p>
<p>Neighbourhood: square (choose size), disk, or more complicated <em>structuring
element</em>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/kernels.png"><img alt="../../_images/kernels.png" src="../../_images/kernels.png" style="width: 759.6px; height: 248.4px;" /></a>
</figure>
<section id="blurring-smoothing">
<h3><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">2.6.4.1. </span>Blurring/smoothing</a><a class="headerlink" href="#blurring-smoothing" title="Link to this heading">¶</a></h3>
<p><strong>Gaussian filter</strong> from <code class="docutils literal notranslate"><span class="pre">scipy.ndimage</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">very_blurred</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Uniform filter</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">local_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">uniform_filter</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_blur.html"><img alt="../../_images/sphx_glr_plot_blur_001.png" src="../../_images/sphx_glr_plot_blur_001.png" style="width: 810.0px; height: 270.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_blur.html#sphx-glr-advanced-image-processing-auto-examples-plot-blur-py"><span class="std std-ref">Python source code</span></a>]</p>
</section>
<section id="sharpening">
<h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">2.6.4.2. </span>Sharpening</a><a class="headerlink" href="#sharpening" title="Link to this heading">¶</a></h3>
<p>Sharpen a blurred image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">face</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>increase the weight of edges by adding an approximation of the
Laplacian:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filter_blurred_f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">blurred_f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">30</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sharpened</span> <span class="o">=</span> <span class="n">blurred_f</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">blurred_f</span> <span class="o">-</span> <span class="n">filter_blurred_f</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_sharpen.html"><img alt="../../_images/sphx_glr_plot_sharpen_001.png" src="../../_images/sphx_glr_plot_sharpen_001.png" style="width: 780.0px; height: 260.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_sharpen.html#sphx-glr-advanced-image-processing-auto-examples-plot-sharpen-py"><span class="std std-ref">Python source code</span></a>]</p>
</section>
<section id="denoising">
<h3><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">2.6.4.3. </span>Denoising</a><a class="headerlink" href="#denoising" title="Link to this heading">¶</a></h3>
<p>Noisy face:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">230</span><span class="p">:</span><span class="mi">290</span><span class="p">,</span> <span class="mi">220</span><span class="p">:</span><span class="mi">320</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">noisy</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">f</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>A <strong>Gaussian filter</strong> smoothes the noise out… and the edges as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gauss_denoised</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">noisy</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Most local linear isotropic filters blur the image (<code class="docutils literal notranslate"><span class="pre">scipy.ndimage.uniform_filter</span></code>)</p>
<p>A <strong>median filter</strong> preserves better the edges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">med_denoised</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">noisy</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_face_denoise.html"><img alt="../../_images/sphx_glr_plot_face_denoise_001.png" src="../../_images/sphx_glr_plot_face_denoise_001.png" style="width: 720.0px; height: 168.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_face_denoise.html#sphx-glr-advanced-image-processing-auto-examples-plot-face-denoise-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>Median filter: better result for straight boundaries (<strong>low curvature</strong>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">distance_transform_bf</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im_noise</span> <span class="o">=</span> <span class="n">im</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im_med</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">im_noise</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_denoising.html"><img alt="../../_images/sphx_glr_plot_denoising_001.png" src="../../_images/sphx_glr_plot_denoising_001.png" style="width: 800.0px; height: 250.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_denoising.html#sphx-glr-advanced-image-processing-auto-examples-plot-denoising-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>Other rank filter: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.maximum_filter</span></code>,
<code class="docutils literal notranslate"><span class="pre">scipy.ndimage.percentile_filter</span></code></p>
<p>Other local non-linear filters: Wiener (<code class="docutils literal notranslate"><span class="pre">scipy.signal.wiener</span></code>), etc.</p>
<p><strong>Non-local filters</strong></p>
<aside class="topic green">
<p class="topic-title"><strong>Exercise: denoising</strong></p>
<ul class="simple">
<li><p>Create a binary image (of 0s and 1s) with several objects (circles,
ellipses, squares, or random shapes).</p></li>
<li><p>Add some noise (e.g., 20% of noise)</p></li>
<li><p>Try two different denoising methods for denoising the image:
gaussian filtering and median filtering.</p></li>
<li><p>Compare the histograms of the two different denoised images.
Which one is the closest to the histogram of the original (noise-free)
image?</p></li>
</ul>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>More denoising filters are available in <code class="xref py py-mod docutils literal notranslate"><span class="pre">skimage.denoising</span></code>,
see the <a class="reference internal" href="../../packages/scikit-image/index.html#scikit-image"><span class="std std-ref">scikit-image: image processing</span></a> tutorial.</p>
</div>
</section>
<section id="mathematical-morphology">
<h3><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">2.6.4.4. </span>Mathematical morphology</a><a class="headerlink" href="#mathematical-morphology" title="Link to this heading">¶</a></h3>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">wikipedia</a>
for a definition of mathematical morphology.</p>
<p>Probe an image with a simple shape (a <strong>structuring element</strong>), and
modify this image according to how the shape locally fits or misses the
image.</p>
<p><strong>Structuring element</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span>
<div class="newline"></div><span class="go">array([[False,  True, False],</span>
<div class="newline"></div><span class="go">       [ True,  True,  True],</span>
<div class="newline"></div><span class="go">       [False,  True, False]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">el</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 1, 0],</span>
<div class="newline"></div><span class="go">       [1, 1, 1],</span>
<div class="newline"></div><span class="go">       [0, 1, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-center">
<img alt="../../_images/diamond_kernel.png" src="../../_images/diamond_kernel.png" />
</figure>
<p><strong>Erosion</strong> = minimum filter. Replace the value of a pixel by the minimal value covered by the structuring element.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Erosion removes objects smaller than the structure</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<img alt="../../_images/morpho_mat.png" class="align-center" src="../../_images/morpho_mat.png" />
<p><strong>Dilation</strong>: maximum filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0.,  0.,  0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  1.,  1.,  1.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [0.,  0.,  0.,  0.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
<p>Also works for grey-valued images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">63</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bigger_points</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">distance_transform_bf</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">dilate_dist</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> \
<div class="newline"></div><span class="gp">... </span>        <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_greyscale_dilation.html"><img alt="../../_images/sphx_glr_plot_greyscale_dilation_001.png" src="../../_images/sphx_glr_plot_greyscale_dilation_001.png" style="width: 500.0px; height: 120.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_greyscale_dilation.html#sphx-glr-advanced-image-processing-auto-examples-plot-greyscale-dilation-py"><span class="std std-ref">Python source code</span></a>]</p>
<p><strong>Opening</strong>: erosion + dilation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 1]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening removes small objects</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening can also smooth corners</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 1, 1, 1, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 1, 0, 0],</span>
<div class="newline"></div><span class="go">       [0, 0, 0, 0, 0]])</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Application</strong>: remove noise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">32</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">open_square</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">eroded_square</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">reconstruction</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_propagation</span><span class="p">(</span><span class="n">eroded_square</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">square</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_propagation.html"><img alt="../../_images/sphx_glr_plot_propagation_001.png" src="../../_images/sphx_glr_plot_propagation_001.png" style="width: 380.0px; height: 120.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_propagation.html#sphx-glr-advanced-image-processing-auto-examples-plot-propagation-py"><span class="std std-ref">Python source code</span></a>]</p>
<p><strong>Closing</strong>: dilation + erosion</p>
<p>Many other mathematical morphology operations: hit and miss transform, tophat,
etc.</p>
</section>
</section>
<section id="feature-extraction">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">2.6.5. </span>Feature extraction</a><a class="headerlink" href="#feature-extraction" title="Link to this heading">¶</a></h2>
<section id="edge-detection">
<h3><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">2.6.5.1. </span>Edge detection</a><a class="headerlink" href="#edge-detection" title="Link to this heading">¶</a></h3>
<p>Synthetic data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[</span><span class="mi">64</span><span class="p">:</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span><span class="o">-</span><span class="mi">64</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Use a <strong>gradient operator</strong> (<strong>Sobel</strong>) to find high intensity variations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">sobel</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sy</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">sobel</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_find_edges.html"><img alt="../../_images/sphx_glr_plot_find_edges_001.png" src="../../_images/sphx_glr_plot_find_edges_001.png" style="width: 640.0px; height: 200.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_find_edges.html#sphx-glr-advanced-image-processing-auto-examples-plot-find-edges-py"><span class="std std-ref">Python source code</span></a>]</p>
</section>
<section id="segmentation">
<h3><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">2.6.5.2. </span>Segmentation</a><a class="headerlink" href="#segmentation" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Histogram-based</strong> segmentation (no spatial information)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="mi">256</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">l</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">im</span> <span class="o">&gt;</span> <span class="n">im</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">+=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">im</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">mask</span> <span class="o">+</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">bin_centers</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">binary_img</span> <span class="o">=</span> <span class="n">img</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_histo_segmentation.html"><img alt="../../_images/sphx_glr_plot_histo_segmentation_001.png" src="../../_images/sphx_glr_plot_histo_segmentation_001.png" style="width: 715.0px; height: 260.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_histo_segmentation.html#sphx-glr-advanced-image-processing-auto-examples-plot-histo-segmentation-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>Use mathematical morphology to clean up the result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove small white regions</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">open_img</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">binary_img</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Remove small black hole</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">close_img</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">open_img</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_clean_morpho.html"><img alt="../../_images/sphx_glr_plot_clean_morpho_001.png" src="../../_images/sphx_glr_plot_clean_morpho_001.png" style="width: 780.0px; height: 195.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_clean_morpho.html#sphx-glr-advanced-image-processing-auto-examples-plot-clean-morpho-py"><span class="std std-ref">Python source code</span></a>]</p>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<p>Check that reconstruction operations (erosion + propagation) produce a
better result than opening/closing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eroded_img</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">binary_img</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">reconstruct_img</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_propagation</span><span class="p">(</span><span class="n">eroded_img</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">binary_img</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">reconstruct_img</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">eroded_tmp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">reconstruct_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_propagation</span><span class="p">(</span><span class="n">eroded_tmp</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">tmp</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mask</span> <span class="o">-</span> <span class="n">close_img</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">0.00640699...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mask</span> <span class="o">-</span> <span class="n">reconstruct_final</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">0.00082232...</span>
<div class="newline"></div></pre></div>
</div>
</aside>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<p>Check how a first denoising step (e.g. with a median filter)
modifies the histogram, and check that the resulting histogram-based
segmentation is more accurate.</p>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>More advanced segmentation algorithms are found in the
<code class="docutils literal notranslate"><span class="pre">scikit-image</span></code>: see <a class="reference internal" href="../../packages/scikit-image/index.html#scikit-image"><span class="std std-ref">scikit-image: image processing</span></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Other Scientific Packages provide algorithms that can be useful for
image processing. In this example, we use the spectral clustering
function of the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> in order to segment glued objects.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="kn">import</span> <span class="n">image</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">spectral_clustering</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="mi">100</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">center1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">center2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">center3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">67</span><span class="p">,</span> <span class="mi">58</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">center4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">radius1</span><span class="p">,</span> <span class="n">radius2</span><span class="p">,</span> <span class="n">radius3</span><span class="p">,</span> <span class="n">radius4</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">circle1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">center1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">radius1</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">circle2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">center2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">radius2</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">circle3</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">center3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">radius3</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">circle4</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center4</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">center4</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">radius4</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 4 circles</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">circle1</span> <span class="o">+</span> <span class="n">circle2</span> <span class="o">+</span> <span class="n">circle3</span> <span class="o">+</span> <span class="n">circle4</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert the image into a graph with the value of the gradient on</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># the edges.</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">img_to_graph</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Take a decreasing function of the gradient: we take it weakly</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># dependent from the gradient the segmentation is close to a voronoi</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">graph</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">graph</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">spectral_clustering</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">eigen_solver</span><span class="o">=</span><span class="s1">&#39;arpack&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">label_im</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">label_im</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
<div class="newline"></div></pre></div>
</div>
<img alt="../../_images/image_spectral_clustering.png" class="align-center" src="../../_images/image_spectral_clustering.png" />
</div>
</section>
</section>
<section id="measuring-objects-properties-scipy-ndimage-measurements">
<h2><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">2.6.6. </span>Measuring objects properties: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.measurements</span></code></a><a class="headerlink" href="#measuring-objects-properties-scipy-ndimage-measurements" title="Link to this heading">¶</a></h2>
<p>Synthetic data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="mi">256</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">l</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">im</span> <span class="o">&gt;</span> <span class="n">im</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<ul class="simple">
<li><p><strong>Analysis of connected components</strong></p></li>
</ul>
<p>Label connected components: <code class="docutils literal notranslate"><span class="pre">scipy.dimage.label</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">label_im</span><span class="p">,</span> <span class="n">nb_labels</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">nb_labels</span> <span class="c1"># how many regions?</span>
<div class="newline"></div><span class="go">28</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">label_im</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_synthetic_data.html"><img alt="../../_images/sphx_glr_plot_synthetic_data_001.png" src="../../_images/sphx_glr_plot_synthetic_data_001.png" style="width: 810.0px; height: 270.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_synthetic_data.html#sphx-glr-advanced-image-processing-auto-examples-plot-synthetic-data-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>Compute size, mean_value, etc. of each region:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sizes</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">label_im</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mean_vals</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label_im</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_labels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<p>Clean up small connect components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask_size</span> <span class="o">=</span> <span class="n">sizes</span> <span class="o">&lt;</span> <span class="mi">1000</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">remove_pixel</span> <span class="o">=</span> <span class="n">mask_size</span><span class="p">[</span><span class="n">label_im</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">remove_pixel</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(256, 256)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">label_im</span><span class="p">[</span><span class="n">remove_pixel</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">label_im</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>Now reassign labels with <code class="docutils literal notranslate"><span class="pre">np.searchsorted</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">label_im</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">label_im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">label_im</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_measure_data.html"><img alt="../../_images/sphx_glr_plot_measure_data_001.png" src="../../_images/sphx_glr_plot_measure_data_001.png" style="width: 540.0px; height: 270.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_measure_data.html#sphx-glr-advanced-image-processing-auto-examples-plot-measure-data-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>Find region of interest enclosing object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">slice_x</span><span class="p">,</span> <span class="n">slice_y</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">label_im</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">roi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="n">slice_x</span><span class="p">,</span> <span class="n">slice_y</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
<div class="newline"></div><span class="go">&lt;matplotlib.image.AxesImage object at 0x...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_find_object.html"><img alt="../../_images/sphx_glr_plot_find_object_001.png" src="../../_images/sphx_glr_plot_find_object_001.png" style="width: 520.0px; height: 260.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_find_object.html#sphx-glr-advanced-image-processing-auto-examples-plot-find-object-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>Other spatial measures: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.center_of_mass</span></code>,
<code class="docutils literal notranslate"><span class="pre">scipy.ndimage.maximum_position</span></code>, etc.</p>
<p>Can be used outside the limited scope of segmentation applications.</p>
<p>Example: block mean:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">sx</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">sy</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">regions</span> <span class="o">=</span> <span class="p">(</span><span class="n">sy</span><span class="o">//</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">//</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Y</span><span class="o">//</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># note that we use broadcasting</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">block_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">regions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">regions</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">block_mean</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">sx</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sy</span> <span class="o">//</span> <span class="mi">6</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_block_mean.html"><img alt="../../_images/sphx_glr_plot_block_mean_001.png" src="../../_images/sphx_glr_plot_block_mean_001.png" style="width: 350.0px; height: 350.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_block_mean.html#sphx-glr-advanced-image-processing-auto-examples-plot-block-mean-py"><span class="std std-ref">Python source code</span></a>]</p>
<p>When regions are regular blocks, it is more efficient to use stride
tricks (<a class="reference internal" href="../advanced_numpy/index.html#stride-manipulation-label"><span class="std std-ref">Example: fake dimensions with strides</span></a>).</p>
<p>Non-regularly-spaced blocks: radial mean:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">sx</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">sy</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">sx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">sy</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rbin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="o">*</span> <span class="n">r</span><span class="o">/</span><span class="n">r</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">radial_mean</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">rbin</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rbin</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_radial_mean.html"><img alt="../../_images/sphx_glr_plot_radial_mean_001.png" src="../../_images/sphx_glr_plot_radial_mean_001.png" style="width: 350.0px; height: 350.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_radial_mean.html#sphx-glr-advanced-image-processing-auto-examples-plot-radial-mean-py"><span class="std std-ref">Python source code</span></a>]</p>
<ul class="simple">
<li><p><strong>Other measures</strong></p></li>
</ul>
<p>Correlation function, Fourier/wavelet spectrum, etc.</p>
<p>One example with mathematical morphology: <a class="reference external" href="https://en.wikipedia.org/wiki/Granulometry_%28morphology%29">granulometry</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">disk_structure</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">struct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">struct</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">granulometry</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">s</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">if</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<div class="newline"></div><span class="gp">... </span>        <span class="n">sizes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">... </span>    <span class="n">granulo</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> \
<div class="newline"></div><span class="gp">... </span>        <span class="n">structure</span><span class="o">=</span><span class="n">disk_structure</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">]</span>
<div class="newline"></div><span class="gp">... </span>    <span class="k">return</span> <span class="n">granulo</span>
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="mi">256</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">l</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">im</span> <span class="o">&gt;</span> <span class="n">im</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">granulo</span> <span class="o">=</span> <span class="n">granulometry</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<div class="newline"></div></pre></div>
</div>
<figure class="align-default">
<a class="reference external image-reference" href="auto_examples/plot_granulo.html"><img alt="../../_images/sphx_glr_plot_granulo_001.png" src="../../_images/sphx_glr_plot_granulo_001.png" style="width: 600.0px; height: 220.0px;" /></a>
</figure>
<p>[<a class="reference internal" href="auto_examples/plot_granulo.html#sphx-glr-advanced-image-processing-auto-examples-plot-granulo-py"><span class="std std-ref">Python source code</span></a>]</p>
</section>
<section id="full-code-examples">
<h2><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">2.6.7. </span>Full code examples</a><a class="headerlink" href="#full-code-examples" title="Link to this heading">¶</a></h2>
</section>
<section id="examples-for-the-image-processing-chapter">
<h2><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">2.6.8. </span>Examples for the image processing chapter</a><a class="headerlink" href="#examples-for-the-image-processing-chapter" title="Link to this heading">¶</a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Small example to plot a raccoon face."><img alt="" src="../../_images/sphx_glr_plot_face_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-face-py"><span class="std std-ref">Displaying a Raccoon Face</span></a></p>
  <div class="sphx-glr-thumbnail-title">Displaying a Raccoon Face</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="The example demonstrates image interpolation on a Raccoon face."><img alt="" src="../../_images/sphx_glr_plot_interpolation_face_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_interpolation_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-interpolation-face-py"><span class="std std-ref">Image interpolation</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image interpolation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="An example showing how to use broad-casting to plot the mean of blocks of an image."><img alt="" src="../../_images/sphx_glr_plot_block_mean_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_block_mean.html#sphx-glr-advanced-image-processing-auto-examples-plot-block-mean-py"><span class="std std-ref">Plot the block mean of an image</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plot the block mean of an image</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to do image manipulation using common NumPy arrays tricks."><img alt="" src="../../_images/sphx_glr_plot_numpy_array_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_numpy_array.html#sphx-glr-advanced-image-processing-auto-examples-plot-numpy-array-py"><span class="std std-ref">Image manipulation and NumPy arrays</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image manipulation and NumPy arrays</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to do a radial mean with scikit-image."><img alt="" src="../../_images/sphx_glr_plot_radial_mean_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_radial_mean.html#sphx-glr-advanced-image-processing-auto-examples-plot-radial-mean-py"><span class="std std-ref">Radial mean</span></a></p>
  <div class="sphx-glr-thumbnail-title">Radial mean</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="An example that displays a raccoon face with matplotlib."><img alt="" src="../../_images/sphx_glr_plot_display_face_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_display_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-display-face-py"><span class="std std-ref">Display a Raccoon Face</span></a></p>
  <div class="sphx-glr-thumbnail-title">Display a Raccoon Face</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to sharpen an image in noiseless situation by applying the filter invers..."><img alt="" src="../../_images/sphx_glr_plot_sharpen_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_sharpen.html#sphx-glr-advanced-image-processing-auto-examples-plot-sharpen-py"><span class="std std-ref">Image sharpening</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image sharpening</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="An example showing various processes that blur an image."><img alt="" src="../../_images/sphx_glr_plot_blur_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_blur.html#sphx-glr-advanced-image-processing-auto-examples-plot-blur-py"><span class="std std-ref">Blurring of images</span></a></p>
  <div class="sphx-glr-thumbnail-title">Blurring of images</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="The example generates and displays simple synthetic data."><img alt="" src="../../_images/sphx_glr_plot_synthetic_data_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_synthetic_data.html#sphx-glr-advanced-image-processing-auto-examples-plot-synthetic-data-py"><span class="std std-ref">Synthetic data</span></a></p>
  <div class="sphx-glr-thumbnail-title">Synthetic data</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows simple operations of mathematical morphology."><img alt="" src="../../_images/sphx_glr_plot_propagation_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_propagation.html#sphx-glr-advanced-image-processing-auto-examples-plot-propagation-py"><span class="std std-ref">Opening, erosion, and propagation</span></a></p>
  <div class="sphx-glr-thumbnail-title">Opening, erosion, and propagation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demoes image denoising on a Raccoon face."><img alt="" src="../../_images/sphx_glr_plot_face_denoise_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_face_denoise.html#sphx-glr-advanced-image-processing-auto-examples-plot-face-denoise-py"><span class="std std-ref">Image denoising</span></a></p>
  <div class="sphx-glr-thumbnail-title">Image denoising</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This examples demos some simple geometrical transformations on a Raccoon face."><img alt="" src="../../_images/sphx_glr_plot_geom_face_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_geom_face.html#sphx-glr-advanced-image-processing-auto-examples-plot-geom-face-py"><span class="std std-ref">Geometrical transformations</span></a></p>
  <div class="sphx-glr-thumbnail-title">Geometrical transformations</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to extract the bounding box of the largest object"><img alt="" src="../../_images/sphx_glr_plot_find_object_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_find_object.html#sphx-glr-advanced-image-processing-auto-examples-plot-find-object-py"><span class="std std-ref">Find the bounding box of an object</span></a></p>
  <div class="sphx-glr-thumbnail-title">Find the bounding box of an object</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This examples shows how to measure quantities from various images."><img alt="" src="../../_images/sphx_glr_plot_measure_data_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_measure_data.html#sphx-glr-advanced-image-processing-auto-examples-plot-measure-data-py"><span class="std std-ref">Measurements from images</span></a></p>
  <div class="sphx-glr-thumbnail-title">Measurements from images</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example demoes Total-Variation (TV) denoising on a Raccoon face."><img alt="" src="../../_images/sphx_glr_plot_face_tv_denoise_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_face_tv_denoise.html#sphx-glr-advanced-image-processing-auto-examples-plot-face-tv-denoise-py"><span class="std std-ref">Total Variation denoising</span></a></p>
  <div class="sphx-glr-thumbnail-title">Total Variation denoising</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows the original image, the noisy image, the denoised one (with the median filte..."><img alt="" src="../../_images/sphx_glr_plot_denoising_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_denoising.html#sphx-glr-advanced-image-processing-auto-examples-plot-denoising-py"><span class="std std-ref">Denoising an image with the median filter</span></a></p>
  <div class="sphx-glr-thumbnail-title">Denoising an image with the median filter</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example does simple histogram analysis to perform segmentation."><img alt="" src="../../_images/sphx_glr_plot_histo_segmentation_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_histo_segmentation.html#sphx-glr-advanced-image-processing-auto-examples-plot-histo-segmentation-py"><span class="std std-ref">Histogram segmentation</span></a></p>
  <div class="sphx-glr-thumbnail-title">Histogram segmentation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example illustrates greyscale mathematical morphology."><img alt="" src="../../_images/sphx_glr_plot_greyscale_dilation_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_greyscale_dilation.html#sphx-glr-advanced-image-processing-auto-examples-plot-greyscale-dilation-py"><span class="std std-ref">Greyscale dilation</span></a></p>
  <div class="sphx-glr-thumbnail-title">Greyscale dilation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="The Sobel filter is one of the simplest way of finding edges."><img alt="" src="../../_images/sphx_glr_plot_find_edges_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_find_edges.html#sphx-glr-advanced-image-processing-auto-examples-plot-find-edges-py"><span class="std std-ref">Finding edges with Sobel filters</span></a></p>
  <div class="sphx-glr-thumbnail-title">Finding edges with Sobel filters</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="An example showing how to clean segmentation with mathematical morphology: removing small regio..."><img alt="" src="../../_images/sphx_glr_plot_clean_morpho_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_clean_morpho.html#sphx-glr-advanced-image-processing-auto-examples-plot-clean-morpho-py"><span class="std std-ref">Cleaning segmentation with mathematical morphology</span></a></p>
  <div class="sphx-glr-thumbnail-title">Cleaning segmentation with mathematical morphology</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example performs a Gaussian mixture model analysis of the image histogram to find the righ..."><img alt="" src="../../_images/sphx_glr_plot_GMM_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_GMM.html#sphx-glr-advanced-image-processing-auto-examples-plot-gmm-py"><span class="std std-ref">Segmentation with Gaussian mixture models</span></a></p>
  <div class="sphx-glr-thumbnail-title">Segmentation with Gaussian mixture models</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example shows how to do segmentation with watershed."><img alt="" src="../../_images/sphx_glr_plot_watershed_segmentation_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_watershed_segmentation.html#sphx-glr-advanced-image-processing-auto-examples-plot-watershed-segmentation-py"><span class="std std-ref">Watershed segmentation</span></a></p>
  <div class="sphx-glr-thumbnail-title">Watershed segmentation</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example performs a simple granulometry analysis."><img alt="" src="../../_images/sphx_glr_plot_granulo_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_granulo.html#sphx-glr-advanced-image-processing-auto-examples-plot-granulo-py"><span class="std std-ref">Granulometry</span></a></p>
  <div class="sphx-glr-thumbnail-title">Granulometry</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example uses spectral clustering to do segmentation."><img alt="" src="../../_images/sphx_glr_plot_spectral_clustering_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_spectral_clustering.html#sphx-glr-advanced-image-processing-auto-examples-plot-spectral-clustering-py"><span class="std std-ref">Segmentation with spectral clustering</span></a></p>
  <div class="sphx-glr-thumbnail-title">Segmentation with spectral clustering</div>
</div></div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-footer sphx-glr-footer-gallery docutils container">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/2fc36b8873618e8e3726827b8635669b/auto_examples_python.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">auto_examples_python.zip</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9d6dd5ee0e8e9dbe37b12250922ca2b8/auto_examples_jupyter.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Jupyter</span> <span class="pre">notebooks:</span> <span class="pre">auto_examples_jupyter.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>More on image-processing:</p>
<ul class="simple">
<li><p>The chapter on <a class="reference internal" href="../../packages/scikit-image/index.html#scikit-image"><span class="std std-ref">Scikit-image</span></a></p></li>
<li><p>Other, more powerful and complete modules: <a class="reference external" href="https://opencv-python-tutroals.readthedocs.org/en/latest">OpenCV</a>
(Python bindings), <a class="reference external" href="https://www.cellprofiler.org">CellProfiler</a>,
<a class="reference external" href="https://itk.org/">ITK</a> with Python bindings</p></li>
</ul>
</div>
<p><div style="clear: both"></div></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">2.6. Image manipulation and processing using NumPy and SciPy</a><ul>
<li><a class="reference internal" href="#opening-and-writing-to-image-files">2.6.1. Opening and writing to image files</a></li>
<li><a class="reference internal" href="#displaying-images">2.6.2. Displaying images</a></li>
<li><a class="reference internal" href="#basic-manipulations">2.6.3. Basic manipulations</a><ul>
<li><a class="reference internal" href="#statistical-information">2.6.3.1. Statistical information</a></li>
<li><a class="reference internal" href="#geometrical-transformations">2.6.3.2. Geometrical transformations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-filtering">2.6.4. Image filtering</a><ul>
<li><a class="reference internal" href="#blurring-smoothing">2.6.4.1. Blurring/smoothing</a></li>
<li><a class="reference internal" href="#sharpening">2.6.4.2. Sharpening</a></li>
<li><a class="reference internal" href="#denoising">2.6.4.3. Denoising</a></li>
<li><a class="reference internal" href="#mathematical-morphology">2.6.4.4. Mathematical morphology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#feature-extraction">2.6.5. Feature extraction</a><ul>
<li><a class="reference internal" href="#edge-detection">2.6.5.1. Edge detection</a></li>
<li><a class="reference internal" href="#segmentation">2.6.5.2. Segmentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#measuring-objects-properties-scipy-ndimage-measurements">2.6.6. Measuring objects properties: <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.measurements</span></code></a></li>
<li><a class="reference internal" href="#full-code-examples">2.6.7. Full code examples</a></li>
<li><a class="reference internal" href="#examples-for-the-image-processing-chapter">2.6.8. Examples for the image processing chapter</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../scipy_sparse/other_packages.html"
                          title="previous chapter"><span class="section-number">2.5.4. </span>Other Interesting Packages</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="auto_examples/plot_face.html"
                          title="next chapter"><span class="section-number">2.6.8.1. </span>Displaying a Raccoon Face</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/advanced/image_processing/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="auto_examples/plot_face.html" title="2.6.8.1. Displaying a Raccoon Face"
             >next</a></li>
        <li class="right" >
          <a href="../scipy_sparse/other_packages.html" title="2.5.4. Other Interesting Packages"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scientific Python Lectures</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Advanced topics</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.6. </span>Image manipulation and processing using NumPy and SciPy</a></li>
     
    <!-- Insert a tip toggle in the navigation bar -->
        <li class="left">
        <!-- On click, expand all tips -->
        <!--
        <a>
            <img src="../../_static/plus.png"
                 alt="Expand tips" style="padding: 1ex;"/>
            <span class="hiddenlink">Collapse document to compact view</span>
        </a>
        -->
        </li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scientific-python-lectures/edit/main/advanced/image_processing/index.rst">Edit
      <span class="tooltip">
        Improve this page:<br/>Edit it on Github.
      </span>
    </a>
    </li>
    
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>