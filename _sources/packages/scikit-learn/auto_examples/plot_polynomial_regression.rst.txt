
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "packages/scikit-learn/auto_examples/plot_polynomial_regression.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_packages_scikit-learn_auto_examples_plot_polynomial_regression.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_packages_scikit-learn_auto_examples_plot_polynomial_regression.py:


Plot fitting a 9th order polynomial
====================================

Fits data generated from a 9th order polynomial with model of 4th order
and 9th order polynomials, to demonstrate that often simpler models are
to be preferred

.. GENERATED FROM PYTHON SOURCE LINES 9-29

.. code-block:: Python


    import numpy as np
    import matplotlib.pyplot as plt
    from matplotlib.colors import ListedColormap

    from sklearn import linear_model

    # Create color maps for 3-class classification problem, as with iris
    cmap_light = ListedColormap(["#FFAAAA", "#AAFFAA", "#AAAAFF"])
    cmap_bold = ListedColormap(["#FF0000", "#00FF00", "#0000FF"])


    rng = np.random.default_rng(27446968)
    x = 2 * rng.random(100) - 1

    f = lambda t: 1.2 * t**2 + 0.1 * t**3 - 0.4 * t**5 - 0.5 * t**9
    y = f(x) + 0.4 * rng.normal(size=100)

    x_test = np.linspace(-1, 1, 100)








.. GENERATED FROM PYTHON SOURCE LINES 30-31

The data

.. GENERATED FROM PYTHON SOURCE LINES 31-34

.. code-block:: Python

    plt.figure(figsize=(6, 4))
    plt.scatter(x, y, s=4)




.. image-sg:: /packages/scikit-learn/auto_examples/images/sphx_glr_plot_polynomial_regression_001.png
   :alt: plot polynomial regression
   :srcset: /packages/scikit-learn/auto_examples/images/sphx_glr_plot_polynomial_regression_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.collections.PathCollection object at 0x7f9c74eb1410>



.. GENERATED FROM PYTHON SOURCE LINES 35-38

Fitting 4th and 9th order polynomials

For this we need to engineer features: the n_th powers of x:

.. GENERATED FROM PYTHON SOURCE LINES 38-57

.. code-block:: Python

    plt.figure(figsize=(6, 4))
    plt.scatter(x, y, s=4)

    X = np.array([x**i for i in range(5)]).T
    X_test = np.array([x_test**i for i in range(5)]).T
    regr = linear_model.LinearRegression()
    regr.fit(X, y)
    plt.plot(x_test, regr.predict(X_test), label="4th order")

    X = np.array([x**i for i in range(10)]).T
    X_test = np.array([x_test**i for i in range(10)]).T
    regr = linear_model.LinearRegression()
    regr.fit(X, y)
    plt.plot(x_test, regr.predict(X_test), label="9th order")

    plt.legend(loc="best")
    plt.axis("tight")
    plt.title("Fitting a 4th and a 9th order polynomial")




.. image-sg:: /packages/scikit-learn/auto_examples/images/sphx_glr_plot_polynomial_regression_002.png
   :alt: Fitting a 4th and a 9th order polynomial
   :srcset: /packages/scikit-learn/auto_examples/images/sphx_glr_plot_polynomial_regression_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Fitting a 4th and a 9th order polynomial')



.. GENERATED FROM PYTHON SOURCE LINES 58-59

Ground truth

.. GENERATED FROM PYTHON SOURCE LINES 59-66

.. code-block:: Python

    plt.figure(figsize=(6, 4))
    plt.scatter(x, y, s=4)
    plt.plot(x_test, f(x_test), label="truth")
    plt.axis("tight")
    plt.title("Ground truth (9th order polynomial)")

    plt.show()



.. image-sg:: /packages/scikit-learn/auto_examples/images/sphx_glr_plot_polynomial_regression_003.png
   :alt: Ground truth (9th order polynomial)
   :srcset: /packages/scikit-learn/auto_examples/images/sphx_glr_plot_polynomial_regression_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.219 seconds)


.. _sphx_glr_download_packages_scikit-learn_auto_examples_plot_polynomial_regression.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_polynomial_regression.ipynb <plot_polynomial_regression.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_polynomial_regression.py <plot_polynomial_regression.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
