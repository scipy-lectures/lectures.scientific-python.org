<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Statistics in Python &#8212; Scientific Python Lectures</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=c29d3f28" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/purecss@3.0.0/build/base-min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/foldable_toc.css?v=38a22cee" />
    <script src="../../_static/documentation_options.js?v=3d051f0c"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=0729d509"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="../../_static/scroll_highlight_toc.js?v=cbac5d29"></script>
    <script src="../../_static/foldable_toc.js?v=d65ca516"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.1.6.1. Boxplots and paired differences" href="auto_examples/plot_paired_boxplots.html" />
    <link rel="prev" title="3. Packages and applications" href="../index.html" />
 

<script defer data-domain="lectures.scientific-python.org" src="https://views.scientific-python.org/js/script.js"></script>

  </head><body>
    <!-- Use the header to add javascript -->
    

    <script type="text/javascript">
     // Function to toggle tip div
     function toggle_tip_div(obj) {
       $(obj).find("p.summary").remove();

       var content = $(obj).text();
       var html = $(obj).html();

       if ($(obj).hasClass("collapsed")) {
         // Expand
         $(obj).html('<p class="summary"><img src="../../_static/minus.png"></p>' + html);
       } else {
         // Collapse
         if(content.length > 50) {
           content = content.substr(0, 47);
         }
         $(obj).html('<p class="summary"><img src="../../_static/plus.png">' + content + '...</p>' + html);
       }

       $(obj).toggleClass("collapsed");
     }

     $(document).ready(function () {
       $(".tip").each(function() {
         $(this).find("p.admonition-title").remove();
       });
       // Collapse all tips and add plus sign
       $(".tip").each(function() { toggle_tip_div($(this)); });

       $(".tip")
         .click(function(event){
           // Change state of the global button
           $('div.related li.transparent').removeClass('transparent');
           toggle_tip_div($(this));
           if (event.target.tagName.toLowerCase() != "a") {
             return true; //Makes links clickable
           }
         });
     });
    </script>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="auto_examples/plot_paired_boxplots.html" title="3.1.6.1. Boxplots and paired differences"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../index.html" title="3. Packages and applications"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scientific Python Lectures</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U"><span class="section-number">3. </span>Packages and applications</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.1. </span>Statistics in Python</a></li>
     
    <!-- Insert a tip toggle in the navigation bar -->
        <li class="left">
        <!-- On click, expand all tips -->
        <!--
        <a>
            <img src="../../_static/plus.png"
                 alt="Expand tips" style="padding: 1ex;"/>
            <span class="hiddenlink">Collapse document to compact view</span>
        </a>
        -->
        </li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scientific-python-lectures/edit/main/packages/statistics/index.rst">Edit
      <span class="tooltip">
        Improve this page:<br/>Edit it on Github.
      </span>
    </a>
    </li>
    
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="statistics-in-python">
<span id="statistics"></span><h1><span class="section-number">3.1. </span>Statistics in Python<a class="headerlink" href="#statistics-in-python" title="Link to this heading">¶</a></h1>
<p><strong>Author</strong>: <em>Gaël Varoquaux</em></p>
<aside class="topic">
<p class="topic-title"><strong>Requirements</strong></p>
<ul class="simple">
<li><p>Standard scientific Python environment (NumPy, SciPy, matplotlib)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/">Pandas</a></p></li>
<li><p><a class="reference external" href="https://www.statsmodels.org/">Statsmodels</a></p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org">Seaborn</a></p></li>
</ul>
<p>To install Python and these dependencies, we recommend that you
download <a class="reference external" href="https://www.anaconda.com/distribution/">Anaconda Python</a> or,
preferably, use the package manager if you are under Ubuntu or other linux.</p>
</aside>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><strong>Bayesian statistics in Python</strong>:
This chapter does not cover tools for Bayesian statistics. Of
particular interest for Bayesian modelling is <a class="reference external" href="https://docs.pymc.io/">PyMC</a>, which implements a probabilistic
programming language in Python.</p></li>
<li><p><strong>Read a statistics book</strong>:
The <a class="reference external" href="https://greenteapress.com/wp/think-stats-2e">Think stats</a> book is
available as free PDF or in print and is a great introduction to
statistics.</p></li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Why Python for statistics?</strong></p>
<p>R is a language dedicated to statistics. Python is a general-purpose
language with statistics modules. R has more statistical analysis
features than Python, and specialized syntaxes. However, when it
comes to building complex analysis pipelines that mix statistics with
e.g. image analysis, text mining, or control of a physical
experiment, the richness of Python is an invaluable asset.</p>
</div>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#data-representation-and-interaction" id="id1">Data representation and interaction</a></p>
<ul>
<li><p><a class="reference internal" href="#data-as-a-table" id="id2">Data as a table</a></p></li>
<li><p><a class="reference internal" href="#the-pandas-data-frame" id="id3">The pandas data-frame</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#hypothesis-testing-comparing-two-groups" id="id4">Hypothesis testing: comparing two groups</a></p>
<ul>
<li><p><a class="reference internal" href="#student-s-t-test-the-simplest-statistical-test" id="id5">Student’s t-test: the simplest statistical test</a></p></li>
<li><p><a class="reference internal" href="#paired-tests-repeated-measurements-on-the-same-individuals" id="id6">Paired tests: repeated measurements on the same individuals</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#linear-models-multiple-factors-and-analysis-of-variance" id="id7">Linear models, multiple factors, and analysis of variance</a></p>
<ul>
<li><p><a class="reference internal" href="#formulas-to-specify-statistical-models-in-python" id="id8">“formulas” to specify statistical models in Python</a></p></li>
<li><p><a class="reference internal" href="#multiple-regression-including-multiple-factors" id="id9">Multiple Regression: including multiple factors</a></p></li>
<li><p><a class="reference internal" href="#post-hoc-hypothesis-testing-analysis-of-variance-anova" id="id10">Post-hoc hypothesis testing: analysis of variance (ANOVA)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#more-visualization-seaborn-for-statistical-exploration" id="id11">More visualization: seaborn for statistical exploration</a></p>
<ul>
<li><p><a class="reference internal" href="#pairplot-scatter-matrices" id="id12">Pairplot: scatter matrices</a></p></li>
<li><p><a class="reference internal" href="#lmplot-plotting-a-univariate-regression" id="id13">lmplot: plotting a univariate regression</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#testing-for-interactions" id="id14">Testing for interactions</a></p></li>
<li><p><a class="reference internal" href="#full-code-for-the-figures" id="id15">Full code for the figures</a></p></li>
<li><p><a class="reference internal" href="#solutions-to-this-chapter-s-exercises" id="id16">Solutions to this chapter’s exercises</a></p></li>
</ul>
</nav>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In this document, the Python inputs are represented with the sign
“&gt;&gt;&gt;”.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Disclaimer: Gender questions</strong></p>
<p>Some of the examples of this tutorial are chosen around gender
questions. The reason is that on such questions controlling the truth
of a claim actually matters to many people.</p>
</div>
<section id="data-representation-and-interaction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">3.1.1. </span>Data representation and interaction</a><a class="headerlink" href="#data-representation-and-interaction" title="Link to this heading">¶</a></h2>
<section id="data-as-a-table">
<h3><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">3.1.1.1. </span>Data as a table</a><a class="headerlink" href="#data-as-a-table" title="Link to this heading">¶</a></h3>
<p>The setting that we consider for statistical analysis is that of multiple
<em>observations</em> or <em>samples</em> described by a set of different <em>attributes</em>
or <em>features</em>. The data can than be seen as a 2D table, or matrix, with
columns giving the different attributes of the data, and rows the
observations. For instance, the data contained in
<a class="reference download internal" download="" href="../../_downloads/cc48b617db83afe66c7e4e955ea3f3bd/brain_size.csv"><code class="xref download docutils literal notranslate"><span class="pre">examples/brain_size.csv</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="s2">&quot;Gender&quot;</span><span class="p">;</span><span class="s2">&quot;FSIQ&quot;</span><span class="p">;</span><span class="s2">&quot;VIQ&quot;</span><span class="p">;</span><span class="s2">&quot;PIQ&quot;</span><span class="p">;</span><span class="s2">&quot;Weight&quot;</span><span class="p">;</span><span class="s2">&quot;Height&quot;</span><span class="p">;</span><span class="s2">&quot;MRI_Count&quot;</span>
<div class="newline"></div><span class="s2">&quot;1&quot;</span><span class="p">;</span><span class="s2">&quot;Female&quot;</span><span class="p">;</span><span class="mi">133</span><span class="p">;</span><span class="mi">132</span><span class="p">;</span><span class="mi">124</span><span class="p">;</span><span class="s2">&quot;118&quot;</span><span class="p">;</span><span class="s2">&quot;64.5&quot;</span><span class="p">;</span><span class="mi">816932</span>
<div class="newline"></div><span class="s2">&quot;2&quot;</span><span class="p">;</span><span class="s2">&quot;Male&quot;</span><span class="p">;</span><span class="mi">140</span><span class="p">;</span><span class="mi">150</span><span class="p">;</span><span class="mi">124</span><span class="p">;</span><span class="s2">&quot;.&quot;</span><span class="p">;</span><span class="s2">&quot;72.5&quot;</span><span class="p">;</span><span class="mi">1001121</span>
<div class="newline"></div><span class="s2">&quot;3&quot;</span><span class="p">;</span><span class="s2">&quot;Male&quot;</span><span class="p">;</span><span class="mi">139</span><span class="p">;</span><span class="mi">123</span><span class="p">;</span><span class="mi">150</span><span class="p">;</span><span class="s2">&quot;143&quot;</span><span class="p">;</span><span class="s2">&quot;73.3&quot;</span><span class="p">;</span><span class="mi">1038437</span>
<div class="newline"></div><span class="s2">&quot;4&quot;</span><span class="p">;</span><span class="s2">&quot;Male&quot;</span><span class="p">;</span><span class="mi">133</span><span class="p">;</span><span class="mi">129</span><span class="p">;</span><span class="mi">128</span><span class="p">;</span><span class="s2">&quot;172&quot;</span><span class="p">;</span><span class="s2">&quot;68.8&quot;</span><span class="p">;</span><span class="mi">965353</span>
<div class="newline"></div><span class="s2">&quot;5&quot;</span><span class="p">;</span><span class="s2">&quot;Female&quot;</span><span class="p">;</span><span class="mi">137</span><span class="p">;</span><span class="mi">132</span><span class="p">;</span><span class="mi">134</span><span class="p">;</span><span class="s2">&quot;147&quot;</span><span class="p">;</span><span class="s2">&quot;65.0&quot;</span><span class="p">;</span><span class="mi">951545</span>
<div class="newline"></div></pre></div>
</div>
</section>
<section id="the-pandas-data-frame">
<h3><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">3.1.1.2. </span>The pandas data-frame</a><a class="headerlink" href="#the-pandas-data-frame" title="Link to this heading">¶</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We will store and manipulate this data in a
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>, from the <a class="reference external" href="https://pandas.pydata.org">pandas</a> module. It is the Python equivalent of
the spreadsheet table. It is different from a 2D <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array as it
has named columns, can contain a mixture of different data types by
column, and has elaborate selection and pivotal mechanisms.</p>
</div>
<section id="creating-dataframes-reading-data-files-or-converting-arrays">
<h4>Creating dataframes: reading data files or converting arrays<a class="headerlink" href="#creating-dataframes-reading-data-files-or-converting-arrays" title="Link to this heading">¶</a></h4>
<aside class="sidebar">
<p class="sidebar-title"><strong>Separator</strong></p>
<p>It is a CSV file, but the separator is “;”</p>
</aside>
<p><strong>Reading from a CSV file:</strong> Using the above CSV file that gives
observations of brain size and weight and IQ (Willerman et al. 1991), the
data are a mixture of numerical and categorical values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;examples/brain_size.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<div class="newline"></div><span class="go">    Unnamed: 0  Gender  FSIQ  VIQ  PIQ  Weight  Height  MRI_Count</span>
<div class="newline"></div><span class="go">0            1  Female   133  132  124   118.0    64.5     816932</span>
<div class="newline"></div><span class="go">1            2    Male   140  150  124     NaN    72.5    1001121</span>
<div class="newline"></div><span class="go">2            3    Male   139  123  150   143.0    73.3    1038437</span>
<div class="newline"></div><span class="go">3            4    Male   133  129  128   172.0    68.8     965353</span>
<div class="newline"></div><span class="go">4            5  Female   137  132  134   147.0    65.0     951545</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Missing values</strong></p>
<p>The weight of the second individual is missing in the CSV file. If we
don’t specify the missing value (NA = not available) marker, we will
not be able to do statistical analysis.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Creating from arrays</strong>: A <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> can also be seen
as a dictionary of 1D ‘series’, eg arrays or lists. If we have 3
<code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sin_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">cos_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>We can expose them as a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;sin&#39;</span><span class="p">:</span> <span class="n">sin_t</span><span class="p">,</span> <span class="s1">&#39;cos&#39;</span><span class="p">:</span> <span class="n">cos_t</span><span class="p">})</span>
<div class="newline"></div><span class="go">           t       sin       cos</span>
<div class="newline"></div><span class="go">0  -6.000000  0.279415  0.960170</span>
<div class="newline"></div><span class="go">1  -5.368421  0.792419  0.609977</span>
<div class="newline"></div><span class="go">2  -4.736842  0.999701  0.024451</span>
<div class="newline"></div><span class="go">3  -4.105263  0.821291 -0.570509</span>
<div class="newline"></div><span class="go">4  -3.473684  0.326021 -0.945363</span>
<div class="newline"></div><span class="go">5  -2.842105 -0.295030 -0.955488</span>
<div class="newline"></div><span class="go">6  -2.210526 -0.802257 -0.596979</span>
<div class="newline"></div><span class="go">7  -1.578947 -0.999967 -0.008151</span>
<div class="newline"></div><span class="go">8  -0.947368 -0.811882  0.583822</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div></pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Other inputs</strong>: <a class="reference external" href="https://pandas.pydata.org">pandas</a> can input data from
SQL, excel files, or other formats. See the <a class="reference external" href="https://pandas.pydata.org">pandas documentation</a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="manipulating-data">
<h4>Manipulating data<a class="headerlink" href="#manipulating-data" title="Link to this heading">¶</a></h4>
<p><cite>data</cite> is a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>, that resembles R’s dataframe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># 40 rows and 8 columns</span>
<div class="newline"></div><span class="go">(40, 8)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># It has columns</span>
<div class="newline"></div><span class="go">Index([&#39;Unnamed: 0&#39;, &#39;Gender&#39;, &#39;FSIQ&#39;, &#39;VIQ&#39;, &#39;PIQ&#39;, &#39;Weight&#39;, &#39;Height&#39;,</span>
<div class="newline"></div><span class="go">       &#39;MRI_Count&#39;],</span>
<div class="newline"></div><span class="go">      dtype=&#39;object&#39;)</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">])</span>  <span class="c1"># Columns can be addressed by name</span>
<div class="newline"></div><span class="go">0     Female</span>
<div class="newline"></div><span class="go">1       Male</span>
<div class="newline"></div><span class="go">2       Male</span>
<div class="newline"></div><span class="go">3       Male</span>
<div class="newline"></div><span class="go">4     Female</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simpler selector</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">][</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">109.45</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a quick view on a large dataframe, use its <cite>describe</cite>
method: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html#pandas.DataFrame.describe" title="(in pandas v2.2.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.describe()</span></code></a>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>groupby</strong>: splitting a dataframe on values of categorical variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">groupby_gender</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">gender</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">groupby_gender</span><span class="p">[</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]:</span>
<div class="newline"></div><span class="gp">... </span>    <span class="nb">print</span><span class="p">((</span><span class="n">gender</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<div class="newline"></div><span class="go">(&#39;Female&#39;, 109.45)</span>
<div class="newline"></div><span class="go">(&#39;Male&#39;, 115.25)</span>
<div class="newline"></div></pre></div>
</div>
<p><cite>groupby_gender</cite> is a powerful object that exposes many
operations on the resulting group of dataframes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">groupby_gender</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">        Unnamed: 0   FSIQ     VIQ     PIQ      Weight     Height  MRI_Count</span>
<div class="newline"></div><span class="go">Gender</span>
<div class="newline"></div><span class="go">Female       19.65  111.9  109.45  110.45  137.200000  65.765000   862654.6</span>
<div class="newline"></div><span class="go">Male         21.35  115.0  115.25  111.60  166.444444  71.431579   954855.4</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use tab-completion on <cite>groupby_gender</cite> to find more.  Other common
grouping functions are median, count (useful for checking to see the
amount of missing values in different subsets) or sum.  Groupby
evaluation is lazy, no work is done until an aggregation function is
applied.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="../../_images/sphx_glr_plot_pandas_001.png" class="align-right" src="../../_images/sphx_glr_plot_pandas_001.png" style="width: 268.8px; height: 201.6px;" /></a>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<ul>
<li><p>What is the mean value for VIQ for the full population?</p></li>
<li><p>How many males/females were included in this study?</p>
<p><strong>Hint</strong> use ‘tab completion’ to find out the methods that can be
called, instead of ‘mean’ in the above example.</p>
</li>
<li><p>What is the average value of MRI counts expressed in log units, for
males and females?</p></li>
</ul>
</aside>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>groupby_gender.boxplot</cite> is used for the plots above (see <a class="reference external" href="auto_examples/plot_pandas.html">this
example</a>).</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="plotting-data">
<h4>Plotting data<a class="headerlink" href="#plotting-data" title="Link to this heading">¶</a></h4>
<p>Pandas comes with some plotting tools (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pandas.plotting</span></code>, using
matplotlib behind the scene) to display statistics of the data in
dataframes:</p>
<p><strong>Scatter matrices</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">plotting</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Weight&#39;</span><span class="p">,</span> <span class="s1">&#39;Height&#39;</span><span class="p">,</span> <span class="s1">&#39;MRI_Count&#39;</span><span class="p">]])</span>
<div class="newline"></div><span class="go">array([[&lt;Axes: xlabel=&#39;Weight&#39;, ylabel=&#39;Weight&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;Height&#39;, ylabel=&#39;Weight&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;MRI_Count&#39;, ylabel=&#39;Weight&#39;&gt;],</span>
<div class="newline"></div><span class="go">       [&lt;Axes: xlabel=&#39;Weight&#39;, ylabel=&#39;Height&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;Height&#39;, ylabel=&#39;Height&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;MRI_Count&#39;, ylabel=&#39;Height&#39;&gt;],</span>
<div class="newline"></div><span class="go">       [&lt;Axes: xlabel=&#39;Weight&#39;, ylabel=&#39;MRI_Count&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;Height&#39;, ylabel=&#39;MRI_Count&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;MRI_Count&#39;, ylabel=&#39;MRI_Count&#39;&gt;]], dtype=object)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="../../_images/sphx_glr_plot_pandas_002.png" class="align-center" src="../../_images/sphx_glr_plot_pandas_002.png" style="width: 448.0px; height: 336.0px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">,</span> <span class="s1">&#39;VIQ&#39;</span><span class="p">,</span> <span class="s1">&#39;FSIQ&#39;</span><span class="p">]])</span>
<div class="newline"></div><span class="go">array([[&lt;Axes: xlabel=&#39;PIQ&#39;, ylabel=&#39;PIQ&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;VIQ&#39;, ylabel=&#39;PIQ&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;FSIQ&#39;, ylabel=&#39;PIQ&#39;&gt;],</span>
<div class="newline"></div><span class="go">       [&lt;Axes: xlabel=&#39;PIQ&#39;, ylabel=&#39;VIQ&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;VIQ&#39;, ylabel=&#39;VIQ&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;FSIQ&#39;, ylabel=&#39;VIQ&#39;&gt;],</span>
<div class="newline"></div><span class="go">       [&lt;Axes: xlabel=&#39;PIQ&#39;, ylabel=&#39;FSIQ&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;VIQ&#39;, ylabel=&#39;FSIQ&#39;&gt;,</span>
<div class="newline"></div><span class="go">        &lt;Axes: xlabel=&#39;FSIQ&#39;, ylabel=&#39;FSIQ&#39;&gt;]], dtype=object)</span>
<div class="newline"></div></pre></div>
</div>
<aside class="sidebar">
<p class="sidebar-title"><strong>Two populations</strong></p>
<p>The IQ metrics are bimodal, as if there are 2 sub-populations.</p>
</aside>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="../../_images/sphx_glr_plot_pandas_003.png" class="align-center" src="../../_images/sphx_glr_plot_pandas_003.png" style="width: 448.0px; height: 336.0px;" /></a>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<p>Plot the scatter matrix for males only, and for females only. Do you
think that the 2 sub-populations correspond to gender?</p>
</aside>
</section>
</section>
</section>
<section id="hypothesis-testing-comparing-two-groups">
<h2><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">3.1.2. </span>Hypothesis testing: comparing two groups</a><a class="headerlink" href="#hypothesis-testing-comparing-two-groups" title="Link to this heading">¶</a></h2>
<p>For simple <a class="reference external" href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing">statistical tests</a>, we will
use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.12.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> sub-module of <a class="reference external" href="https://docs.scipy.org/doc/">SciPy</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>SciPy is a vast library. For a quick summary to the whole library, see
the <a class="reference internal" href="../../intro/scipy/index.html#scipy"><span class="std std-ref">scipy</span></a> chapter.</p>
</div>
<section id="student-s-t-test-the-simplest-statistical-test">
<h3><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">3.1.2.1. </span>Student’s t-test: the simplest statistical test</a><a class="headerlink" href="#student-s-t-test-the-simplest-statistical-test" title="Link to this heading">¶</a></h3>
<section id="one-sample-tests-testing-the-value-of-a-population-mean">
<h4>One-sample tests: testing the value of a population mean<a class="headerlink" href="#one-sample-tests-testing-the-value-of-a-population-mean" title="Link to this heading">¶</a></h4>
<a class="reference internal image-reference" href="../../_images/two_sided.png"><img alt="../../_images/two_sided.png" class="align-right" src="../../_images/two_sided.png" style="width: 228.5px; height: 223.5px;" /></a>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_1samp.html#scipy.stats.ttest_1samp" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.ttest_1samp()</span></code></a> tests the null hypothesis that the mean
of the population underlying the data is equal to a given value. It returns
the <a class="reference external" href="https://en.wikipedia.org/wiki/Student%27s_t-test">T statistic</a>,
and the <a class="reference external" href="https://en.wikipedia.org/wiki/P-value">p-value</a> (see the
function’s help):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;VIQ&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">TtestResult(statistic=30.088099970..., pvalue=1.32891964...e-28, df=39)</span>
<div class="newline"></div></pre></div>
</div>
<p>The p-value of <img class="math" src="../../_images/math/0fb392be745b6cb6e17a7695af3e414f876b5e96.png" alt="10^-28"/> indicates that such an extreme value of the statistic
is unlikely to be observed under the null hypothesis. This may be taken as
evidence that the null hypothesis is false and that the population mean IQ
(VIQ measure) is not 0.</p>
<p>Technically, the p-value of the t-test is derived under the assumption that
the means of samples drawn from the population are normally distributed.
This condition is exactly satisfied when the population itself is normally
distributed; however, due to the central limit theorem, the condition is
nearly true for reasonably large samples drawn from populations that follow
a variety of non-normal distributions.</p>
<p>Nonetheless, if we are concerned that violation of the normality assumptions
will affect the conclusions of the test, we can use a <a class="reference external" href="https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test">Wilcoxon signed-rank test</a>, which relaxes
this assumption at the expense of test power:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;VIQ&#39;</span><span class="p">])</span>
<div class="newline"></div><span class="go">WilcoxonResult(statistic=0.0, pvalue=1.8189894...e-12)</span>
<div class="newline"></div></pre></div>
</div>
</section>
<section id="two-sample-t-test-testing-for-difference-across-populations">
<h4>Two-sample t-test: testing for difference across populations<a class="headerlink" href="#two-sample-t-test-testing-for-difference-across-populations" title="Link to this heading">¶</a></h4>
<p>We have seen above that the mean VIQ in the male and female samples
were different. To test whether this difference is significant (and
suggests that there is a difference in population means), we perform
a two-sample t-test using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.ttest_ind()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">female_viq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span><span class="p">][</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">male_viq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Male&#39;</span><span class="p">][</span><span class="s1">&#39;VIQ&#39;</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">female_viq</span><span class="p">,</span> <span class="n">male_viq</span><span class="p">)</span>
<div class="newline"></div><span class="go">TtestResult(statistic=-0.77261617232..., pvalue=0.4445287677858..., df=38.0)</span>
<div class="newline"></div></pre></div>
</div>
<p>The corresponding non-parametric test is the <a class="reference external" href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U">Mann–Whitney U
test</a>,
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu" title="(in SciPy v1.12.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.stats.mannwhitneyu()</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">female_viq</span><span class="p">,</span> <span class="n">male_viq</span><span class="p">)</span>
<div class="newline"></div><span class="go">MannwhitneyuResult(statistic=164.5, pvalue=0.34228868687...)</span>
<div class="newline"></div></pre></div>
</div>
</section>
</section>
<section id="paired-tests-repeated-measurements-on-the-same-individuals">
<h3><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">3.1.2.2. </span>Paired tests: repeated measurements on the same individuals</a><a class="headerlink" href="#paired-tests-repeated-measurements-on-the-same-individuals" title="Link to this heading">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="../../_images/sphx_glr_plot_paired_boxplots_001.png" class="align-right" src="../../_images/sphx_glr_plot_paired_boxplots_001.png" style="width: 280.0px; height: 210.0px;" /></a>
<p>PIQ, VIQ, and FSIQ give three measures of IQ. Let us test whether FISQ
and PIQ are significantly different. We can use an “independent sample” test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">])</span>
<div class="newline"></div><span class="go">TtestResult(statistic=0.46563759638..., pvalue=0.64277250..., df=78.0)</span>
<div class="newline"></div></pre></div>
</div>
<p>The problem with this approach is that it ignores an important relationship
between observations: FSIQ and PIQ are measured on the same individuals.
Thus, the variance due to inter-subject variability is confounding, reducing
the power of the test. This variability can be removed using a “paired test”
or <a class="reference external" href="https://en.wikipedia.org/wiki/Repeated_measures_design">“repeated measures test”</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">])</span>
<div class="newline"></div><span class="go">TtestResult(statistic=1.784201940..., pvalue=0.082172638183..., df=39)</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_pandas.html"><img alt="../../_images/sphx_glr_plot_paired_boxplots_002.png" class="align-right" src="../../_images/sphx_glr_plot_paired_boxplots_002.png" style="width: 240.0px; height: 180.0px;" /></a>
<p>This is equivalent to a one-sample test on the differences between paired
observations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">TtestResult(statistic=1.784201940..., pvalue=0.082172638..., df=39)</span>
<div class="newline"></div></pre></div>
</div>
<p>Accordingly, we can perform a nonparametric version of the test with
<code class="docutils literal notranslate"><span class="pre">wilcoxon</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;approx&quot;</span><span class="p">)</span>
<div class="newline"></div><span class="go">WilcoxonResult(statistic=274.5, pvalue=0.106594927135...)</span>
<div class="newline"></div></pre></div>
</div>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<ul class="simple">
<li><p>Test the difference between weights in males and females.</p></li>
<li><p>Use non parametric statistics to test the difference between VIQ in
males and females.</p></li>
</ul>
<p><strong>Conclusion</strong>: we find that the data does not support the hypothesis
that males and females have different VIQ.</p>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>
<section id="linear-models-multiple-factors-and-analysis-of-variance">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">3.1.3. </span>Linear models, multiple factors, and analysis of variance</a><a class="headerlink" href="#linear-models-multiple-factors-and-analysis-of-variance" title="Link to this heading">¶</a></h2>
<section id="formulas-to-specify-statistical-models-in-python">
<h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">3.1.3.1. </span>“formulas” to specify statistical models in Python</a><a class="headerlink" href="#formulas-to-specify-statistical-models-in-python" title="Link to this heading">¶</a></h3>
<section id="a-simple-linear-regression">
<h4>A simple linear regression<a class="headerlink" href="#a-simple-linear-regression" title="Link to this heading">¶</a></h4>
<a class="reference external image-reference" href="auto_examples/plot_regression.html"><img alt="../../_images/sphx_glr_plot_regression_001.png" class="align-right" src="../../_images/sphx_glr_plot_regression_001.png" style="width: 300.0px; height: 240.0px;" /></a>
<p>Given two set of observations, <cite>x</cite> and <cite>y</cite>, we want to test the
hypothesis that <cite>y</cite> is a linear function of <cite>x</cite>. In other terms:</p>
<blockquote>
<div><p><img class="math" src="../../_images/math/d0814b9733f6245697bcb517b8af4c0149b3a481.png" alt="y = x * \textit{coef} + \textit{intercept} + e"/></p>
</div></blockquote>
<p>where <cite>e</cite> is observation noise. We will use the <a class="reference external" href="https://www.statsmodels.org/">statsmodels</a> module to:</p>
<ol class="arabic simple">
<li><p>Fit a linear model. We will use the simplest strategy, <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_least_squares">ordinary least
squares</a> (OLS).</p></li>
<li><p>Test that <cite>coef</cite> is non zero.</p></li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>First, we generate simulated data according to the model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">27446968</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># normal distributed noise</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a data frame containing all the relevant variables</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
<div class="newline"></div></pre></div>
</div>
<aside class="sidebar">
<p class="sidebar-title"><strong>“formulas” for statistics in Python</strong></p>
<p><a class="reference external" href="https://www.statsmodels.org/stable/example_formulas.html">See the statsmodels documentation</a></p>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Then we specify an OLS model and fit it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;y ~ x&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<p>We can inspect the various statistics derived from the fit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span> 
<div class="newline"></div><span class="go">                            OLS Regression Results</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Dep. Variable:                      y   R-squared:                       0.901</span>
<div class="newline"></div><span class="go">Model:                            OLS   Adj. R-squared:                  0.896</span>
<div class="newline"></div><span class="go">Method:                 Least Squares   F-statistic:                     164.5</span>
<div class="newline"></div><span class="go">Date:                             ...   Prob (F-statistic):           1.72e-10</span>
<div class="newline"></div><span class="go">Time:                             ...   Log-Likelihood:                -51.758</span>
<div class="newline"></div><span class="go">No. Observations:                  20   AIC:                             107.5</span>
<div class="newline"></div><span class="go">Df Residuals:                      18   BIC:                             109.5</span>
<div class="newline"></div><span class="go">Df Model:                           1</span>
<div class="newline"></div><span class="go">Covariance Type:            nonrobust</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<div class="newline"></div><span class="go">------------------------------------------------------------------------------</span>
<div class="newline"></div><span class="go">Intercept     -4.2948      0.759     -5.661      0.000      -5.889      -2.701</span>
<div class="newline"></div><span class="go">x              3.2060      0.250     12.825      0.000       2.681       3.731</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Omnibus:                        1.218   Durbin-Watson:                   1.796</span>
<div class="newline"></div><span class="go">Prob(Omnibus):                  0.544   Jarque-Bera (JB):                0.999</span>
<div class="newline"></div><span class="go">Skew:                           0.503   Prob(JB):                        0.607</span>
<div class="newline"></div><span class="go">Kurtosis:                       2.568   Cond. No.                         3.03</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div>
<div class="newline"></div><span class="go">Notes:</span>
<div class="newline"></div><span class="go">[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</span>
<div class="newline"></div></pre></div>
</div>
<aside class="topic">
<p class="topic-title">Terminology:</p>
<p>Statsmodels uses a statistical terminology: the <cite>y</cite> variable in
statsmodels is called ‘endogenous’ while the <cite>x</cite> variable is called
exogenous.  This is discussed in more detail <a class="reference external" href="https://www.statsmodels.org/devel/endog_exog.html">here</a>.</p>
<p>To simplify, <cite>y</cite> (endogenous) is the value you are trying to predict,
while <cite>x</cite> (exogenous) represents the features you are using to make
the prediction.</p>
</aside>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<p>Retrieve the estimated parameters from the model above. <strong>Hint</strong>:
use tab-completion to find the relevant attribute.</p>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="categorical-variables-comparing-groups-or-multiple-categories">
<h4>Categorical variables: comparing groups or multiple categories<a class="headerlink" href="#categorical-variables-comparing-groups-or-multiple-categories" title="Link to this heading">¶</a></h4>
<p>Let us go back the data on brain size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;examples/brain_size.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>We can write a comparison between IQ of male and female using a linear
model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;VIQ ~ Gender + 1&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span> 
<div class="newline"></div><span class="go">                            OLS Regression Results</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Dep. Variable:                    VIQ   R-squared:                       0.015</span>
<div class="newline"></div><span class="go">Model:                            OLS   Adj. R-squared:                 -0.010</span>
<div class="newline"></div><span class="go">Method:                 Least Squares   F-statistic:                    0.5969</span>
<div class="newline"></div><span class="go">Date:                             ...   Prob (F-statistic):              0.445</span>
<div class="newline"></div><span class="go">Time:                             ...   Log-Likelihood:                -182.42</span>
<div class="newline"></div><span class="go">No. Observations:                  40   AIC:                             368.8</span>
<div class="newline"></div><span class="go">Df Residuals:                      38   BIC:                             372.2</span>
<div class="newline"></div><span class="go">Df Model:                           1</span>
<div class="newline"></div><span class="go">Covariance Type:            nonrobust</span>
<div class="newline"></div><span class="go">==================================================================================</span>
<div class="newline"></div><span class="go">                     coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<div class="newline"></div><span class="go">----------------------------------------------------------------------------------</span>
<div class="newline"></div><span class="go">Intercept        109.4500      5.308     20.619      0.000      98.704     120.196</span>
<div class="newline"></div><span class="go">Gender[T.Male]     5.8000      7.507      0.773      0.445      -9.397      20.997</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div><span class="go">Omnibus:                       26.188   Durbin-Watson:                   1.709</span>
<div class="newline"></div><span class="go">Prob(Omnibus):                  0.000   Jarque-Bera (JB):                3.703</span>
<div class="newline"></div><span class="go">Skew:                           0.010   Prob(JB):                        0.157</span>
<div class="newline"></div><span class="go">Kurtosis:                       1.510   Cond. No.                         2.62</span>
<div class="newline"></div><span class="go">==============================================================================</span>
<div class="newline"></div>
<div class="newline"></div><span class="go">Notes:</span>
<div class="newline"></div><span class="go">[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</span>
<div class="newline"></div></pre></div>
</div>
<aside class="topic">
<p class="topic-title"><strong>Tips on specifying model</strong></p>
<p><strong>Forcing categorical</strong>: the ‘Gender’ is automatically detected as a
categorical variable, and thus each of its different values are
treated as different entities.</p>
<p>An integer column can be forced to be treated as categorical using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;VIQ ~ C(Gender)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Intercept</strong>: We can remove the intercept using <cite>- 1</cite> in the formula,
or force the use of an intercept using <cite>+ 1</cite>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>By default, statsmodels treats a categorical variable with K possible
values as K-1 ‘dummy’ boolean variables (the last level being
absorbed into the intercept term).  This is almost always a good
default choice - however, it is possible to specify different
encodings for categorical variables
(<a class="reference external" href="https://www.statsmodels.org/devel/contrasts.html">https://www.statsmodels.org/devel/contrasts.html</a>).</p>
</div>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
<aside class="topic">
<p class="topic-title"><strong>Link to t-tests between different FSIQ and PIQ</strong></p>
<p>To compare different types of IQ, we need to create a “long-form”
table, listing IQs, where the type of IQ is indicated by a
categorical variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_fisq</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;iq&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;fsiq&#39;</span><span class="p">})</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data_piq</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;iq&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">],</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;piq&#39;</span><span class="p">})</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">data_long</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">data_fisq</span><span class="p">,</span> <span class="n">data_piq</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_long</span><span class="p">)</span>
<div class="newline"></div><span class="go">     iq  type</span>
<div class="newline"></div><span class="go">0   133  fsiq</span>
<div class="newline"></div><span class="go">1   140  fsiq</span>
<div class="newline"></div><span class="go">2   139  fsiq</span>
<div class="newline"></div><span class="go">3   133  fsiq</span>
<div class="newline"></div><span class="go">4   137  fsiq</span>
<div class="newline"></div><span class="go">...  ...   ...</span>
<div class="newline"></div><span class="go">35  128   piq</span>
<div class="newline"></div><span class="go">36  124   piq</span>
<div class="newline"></div><span class="go">37   94   piq</span>
<div class="newline"></div><span class="go">38   74   piq</span>
<div class="newline"></div><span class="go">39   89   piq</span>
<div class="newline"></div>
<div class="newline"></div><span class="go">[80 rows x 2 columns]</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s2">&quot;iq ~ type&quot;</span><span class="p">,</span> <span class="n">data_long</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span> 
<div class="newline"></div><span class="go">                            OLS Regression Results</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div><span class="go">==========================...</span>
<div class="newline"></div><span class="go">                 coef    std err          t      P&gt;|t|      [0.025      0.975]</span>
<div class="newline"></div><span class="go">------------------------------------------...</span>
<div class="newline"></div><span class="go">Intercept     113.4500      3.683     30.807      0.000       106.119   120.781</span>
<div class="newline"></div><span class="go">type[T.piq]    -2.4250      5.208     -0.466      0.643       -12.793     7.943</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div></pre></div>
</div>
<p>We can see that we retrieve the same values for t-test and
corresponding p-values for the effect of the type of iq than the
previous t-test:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;PIQ&#39;</span><span class="p">])</span>
<div class="newline"></div><span class="go">TtestResult(statistic=0.46563759638..., pvalue=0.64277250..., df=78.0)</span>
<div class="newline"></div></pre></div>
</div>
</aside>
</section>
</section>
<section id="multiple-regression-including-multiple-factors">
<h3><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">3.1.3.2. </span>Multiple Regression: including multiple factors</a><a class="headerlink" href="#multiple-regression-including-multiple-factors" title="Link to this heading">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_regression_3d.html"><img alt="../../_images/sphx_glr_plot_regression_3d_001.png" class="align-right" src="../../_images/sphx_glr_plot_regression_3d_001.png" style="width: 288.0px; height: 216.0px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Consider a linear model explaining a variable <cite>z</cite> (the dependent
variable) with 2 variables <cite>x</cite> and <cite>y</cite>:</p>
<blockquote>
<div><p><img class="math" src="../../_images/math/4d8148edd5d1b4c3ec3e71efaae7c270039081fe.png" alt="z = x \, c_1 + y \, c_2 + i + e"/></p>
</div></blockquote>
<p>Such a model can be seen in 3D as fitting a plane to a cloud of (<cite>x</cite>,
<cite>y</cite>, <cite>z</cite>) points.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>Example: the iris data</strong> (<a class="reference download internal" download="" href="../../_downloads/6c4b367d8ba9371e9254c70abb7496c5/iris.csv"><code class="xref download docutils literal notranslate"><span class="pre">examples/iris.csv</span></code></a>)</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Sepal and petal size tend to be related: bigger flowers are bigger!
But is there in addition a systematic effect of species?</p>
</div>
<a class="reference external image-reference" href="auto_examples/plot_iris_analysis_1.html"><img alt="../../_images/sphx_glr_plot_iris_analysis_001.png" class="align-center" src="../../_images/sphx_glr_plot_iris_analysis_001.png" style="width: 512.0px; height: 384.0px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;examples/iris.csv&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;sepal_width ~ name + petal_length&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span> 
<div class="newline"></div><span class="go">                            OLS Regression Results</span>
<div class="newline"></div><span class="go">==========================...</span>
<div class="newline"></div><span class="go">Dep. Variable:            sepal_width   R-squared:                       0.478</span>
<div class="newline"></div><span class="go">Model:                            OLS   Adj. R-squared:                  0.468</span>
<div class="newline"></div><span class="go">Method:                 Least Squares   F-statistic:                     44.63</span>
<div class="newline"></div><span class="go">Date:                             ...   Prob (F-statistic):           1.58e-20</span>
<div class="newline"></div><span class="go">Time:                             ...   Log-Likelihood:                -38.185</span>
<div class="newline"></div><span class="go">No. Observations:                 150   AIC:                             84.37</span>
<div class="newline"></div><span class="go">Df Residuals:                     146   BIC:                             96.41</span>
<div class="newline"></div><span class="go">Df Model:                           3</span>
<div class="newline"></div><span class="go">Covariance Type:            nonrobust</span>
<div class="newline"></div><span class="go">==========================...</span>
<div class="newline"></div><span class="go">                         coef    std err          t     P&gt;|t|  [0.025      0.975]</span>
<div class="newline"></div><span class="go">------------------------------------------...</span>
<div class="newline"></div><span class="go">Intercept              2.9813      0.099     29.989     0.000      2.785     3.178</span>
<div class="newline"></div><span class="go">name[T.versicolor]    -1.4821      0.181     -8.190     0.000     -1.840    -1.124</span>
<div class="newline"></div><span class="go">name[T.virginica]     -1.6635      0.256     -6.502     0.000     -2.169    -1.158</span>
<div class="newline"></div><span class="go">petal_length           0.2983      0.061      4.920     0.000      0.178     0.418</span>
<div class="newline"></div><span class="go">==========================...</span>
<div class="newline"></div><span class="go">Omnibus:                        2.868   Durbin-Watson:                   1.753</span>
<div class="newline"></div><span class="go">Prob(Omnibus):                  0.238   Jarque-Bera (JB):                2.885</span>
<div class="newline"></div><span class="go">Skew:                          -0.082   Prob(JB):                        0.236</span>
<div class="newline"></div><span class="go">Kurtosis:                       3.659   Cond. No.                         54.0</span>
<div class="newline"></div><span class="go">==========================...</span>
<div class="newline"></div>
<div class="newline"></div><span class="go">Notes:</span>
<div class="newline"></div><span class="go">[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</span>
<div class="newline"></div></pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="post-hoc-hypothesis-testing-analysis-of-variance-anova">
<h3><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">3.1.3.3. </span>Post-hoc hypothesis testing: analysis of variance (ANOVA)</a><a class="headerlink" href="#post-hoc-hypothesis-testing-analysis-of-variance-anova" title="Link to this heading">¶</a></h3>
<p>In the above iris example, we wish to test if the petal length is
different between versicolor and virginica, after removing the effect of
sepal width. This can be formulated as testing the difference between the
coefficient associated to versicolor and virginica in the linear model
estimated above (it is an Analysis of Variance, <a class="reference external" href="https://en.wikipedia.org/wiki/Analysis_of_variance">ANOVA</a>). For this, we
write a <strong>vector of ‘contrast’</strong> on the parameters estimated: we want to
test <code class="docutils literal notranslate"><span class="pre">&quot;name[T.versicolor]</span> <span class="pre">-</span> <span class="pre">name[T.virginica]&quot;</span></code>, with an <a class="reference external" href="https://en.wikipedia.org/wiki/F-test">F-test</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">f_test</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<div class="newline"></div><span class="go">&lt;F test: F=3.24533535..., p=0.07369..., df_denom=146, df_num=1&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>Is this difference significant?</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<aside class="topic green">
<p class="topic-title"><strong>Exercise</strong></p>
<p>Going back to the brain size + IQ data, test if the VIQ of male and
female are different after removing the effect of brain size, height
and weight.</p>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>
<section id="more-visualization-seaborn-for-statistical-exploration">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">3.1.4. </span>More visualization: seaborn for statistical exploration</a><a class="headerlink" href="#more-visualization-seaborn-for-statistical-exploration" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://seaborn.pydata.org">Seaborn</a> combines
simple statistical fits with plotting on pandas dataframes.</p>
<p>Let us consider a data giving wages and many other personal information
on 500 individuals (<a class="reference external" href="https://lib.stat.cmu.edu/datasets/CPS_85_Wages">Berndt, ER. The Practice of Econometrics. 1991. NY:
Addison-Wesley</a>).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The full code loading and plotting of the wages data is found in
<a class="reference external" href="auto_examples/plot_wage_data.html">corresponding example</a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  
<div class="newline"></div><span class="go">     EDUCATION  SOUTH  SEX  EXPERIENCE  UNION      WAGE  AGE  RACE  \</span>
<div class="newline"></div><span class="go">0            8      0    1          21      0  0.707570   35     2</span>
<div class="newline"></div><span class="go">1            9      0    1          42      0  0.694605   57     3</span>
<div class="newline"></div><span class="go">2           12      0    0           1      0  0.824126   19     3</span>
<div class="newline"></div><span class="go">3           12      0    0           4      0  0.602060   22     3</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div></pre></div>
</div>
<section id="pairplot-scatter-matrices">
<h3><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">3.1.4.1. </span>Pairplot: scatter matrices</a><a class="headerlink" href="#pairplot-scatter-matrices" title="Link to this heading">¶</a></h3>
<p>We can easily have an intuition on the interactions between continuous
variables using <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.pairplot.html#seaborn.pairplot" title="(in seaborn v0.13.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.pairplot()</span></code></a> to display a scatter matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">seaborn</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">seaborn</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;WAGE&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;EDUCATION&#39;</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                 <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">)</span>  
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_wage_data.html"><img alt="../../_images/sphx_glr_plot_wage_data_001.png" class="align-center" src="../../_images/sphx_glr_plot_wage_data_001.png" style="width: 450.0px; height: 450.0px;" /></a>
<p>Categorical variables can be plotted as the hue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seaborn</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;WAGE&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;EDUCATION&#39;</span><span class="p">],</span>
<div class="newline"></div><span class="gp">... </span>                 <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;SEX&#39;</span><span class="p">)</span>  
<div class="newline"></div></pre></div>
</div>
<a class="reference external image-reference" href="auto_examples/plot_wage_data.html"><img alt="../../_images/sphx_glr_plot_wage_data_002.png" class="align-center" src="../../_images/sphx_glr_plot_wage_data_002.png" style="width: 484.79999999999995px; height: 450.0px;" /></a>
<aside class="topic">
<p class="topic-title"><strong>Look and feel and matplotlib settings</strong></p>
<p>Seaborn changes the default of matplotlib figures to achieve a more
“modern”, “excel-like” look. It does that upon import. You can reset
the default using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To switch back to seaborn settings, or understand better styling in
seaborn, see the <a class="reference external" href="https://seaborn.pydata.org/tutorial/aesthetics.html">relevant section of the seaborn documentation</a>.</p>
</div>
</aside>
</section>
<section id="lmplot-plotting-a-univariate-regression">
<h3><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">3.1.4.2. </span>lmplot: plotting a univariate regression</a><a class="headerlink" href="#lmplot-plotting-a-univariate-regression" title="Link to this heading">¶</a></h3>
<a class="reference external image-reference" href="auto_examples/plot_wage_data.html"><img alt="../../_images/sphx_glr_plot_wage_data_005.png" class="align-right" src="../../_images/sphx_glr_plot_wage_data_005.png" style="width: 300.0px; height: 300.0px;" /></a>
<p>A regression capturing the relation between one variable and another, eg
wage and eduction, can be plotted using <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.lmplot.html#seaborn.lmplot" title="(in seaborn v0.13.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.lmplot()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">seaborn</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;WAGE&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;EDUCATION&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>  
<div class="newline"></div></pre></div>
</div>
<div style="clear: both"></div><aside class="topic">
<p class="topic-title"><strong>Robust regression</strong></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Given that, in the above plot, there seems to be a couple of data
points that are outside of the main cloud to the right, they might be
outliers, not representative of the population, but driving the
regression.</p>
</div>
<p>To compute a regression that is less sensitive to outliers, one must
use a <a class="reference external" href="https://en.wikipedia.org/wiki/Robust_statistics">robust model</a>. This is done in
seaborn using <code class="docutils literal notranslate"><span class="pre">robust=True</span></code> in the plotting functions, or in
statsmodels by replacing the use of the OLS by a “Robust Linear
Model”, <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.formula.api.rlm.html#statsmodels.formula.api.rlm" title="(in statsmodels 0.14.1 v0.14.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">statsmodels.formula.api.rlm()</span></code></a>.</p>
</aside>
</section>
</section>
<section id="testing-for-interactions">
<h2><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">3.1.5. </span>Testing for interactions</a><a class="headerlink" href="#testing-for-interactions" title="Link to this heading">¶</a></h2>
<a class="reference external image-reference" href="auto_examples/plot_wage_education_gender.html"><img alt="../../_images/sphx_glr_plot_wage_education_gender_001.png" class="align-center" src="../../_images/sphx_glr_plot_wage_education_gender_001.png" style="width: 418.59999999999997px; height: 350.0px;" /></a>
<p>Do wages increase more with education for males than females?</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The plot above is made of two different fits. We need to formulate a
single model that tests for a variance of slope across the two
populations. This is done via an <a class="reference external" href="https://www.statsmodels.org/devel/example_formulas.html#multiplicative-interactions">“interaction”</a>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;wage ~ education + gender + education * gender&#39;</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>    
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>    
<div class="newline"></div><span class="gp">...</span>
<div class="newline"></div><span class="go">                            coef    std err    t     P&gt;|t|  [0.025      0.975]</span>
<div class="newline"></div><span class="go">------------------------------------------------------------------------------</span>
<div class="newline"></div><span class="go">Intercept                   0.2998   0.072    4.173   0.000     0.159   0.441</span>
<div class="newline"></div><span class="go">gender[T.male]              0.2750   0.093    2.972   0.003     0.093   0.457</span>
<div class="newline"></div><span class="go">education                   0.0415   0.005    7.647   0.000     0.031   0.052</span>
<div class="newline"></div><span class="go">education:gender[T.male]   -0.0134   0.007   -1.919   0.056    -0.027   0.000</span>
<div class="newline"></div><span class="go">==========================...</span>
<div class="newline"></div><span class="go">...</span>
<div class="newline"></div></pre></div>
</div>
<p>Can we conclude that education benefits males more than females?</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<aside class="topic">
<p class="topic-title"><strong>Take home messages</strong></p>
<ul class="simple">
<li><p>Hypothesis testing and p-values give you the <strong>significance</strong> of an
effect / difference.</p></li>
<li><p><strong>Formulas</strong> (with categorical variables) enable you to express rich
links in your data.</p></li>
<li><p><strong>Visualizing</strong> your data and fitting simple models give insight into the
data.</p></li>
<li><p><strong>Conditionning</strong> (adding factors that can explain all or part of
the variation) is an important modeling aspect that changes the
interpretation.</p></li>
</ul>
</aside>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="full-code-for-the-figures">
<h2><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">3.1.6. </span>Full code for the figures</a><a class="headerlink" href="#full-code-for-the-figures" title="Link to this heading">¶</a></h2>
<p>Code examples for the statistics chapter.</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Plot boxplots for FSIQ, PIQ, and the paired difference between the two: while the spread (error..."><img alt="" src="../../_images/sphx_glr_plot_paired_boxplots_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_paired_boxplots.html#sphx-glr-packages-statistics-auto-examples-plot-paired-boxplots-py"><span class="std std-ref">Boxplots and paired differences</span></a></p>
  <div class="sphx-glr-thumbnail-title">Boxplots and paired differences</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example loads from a CSV file data with mixed numerical and categorical entries, and plots..."><img alt="" src="../../_images/sphx_glr_plot_pandas_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_pandas.html#sphx-glr-packages-statistics-auto-examples-plot-pandas-py"><span class="std std-ref">Plotting simple quantities of a pandas dataframe</span></a></p>
  <div class="sphx-glr-thumbnail-title">Plotting simple quantities of a pandas dataframe</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Illustrate an analysis on a real dataset:"><img alt="" src="../../_images/sphx_glr_plot_iris_analysis_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_iris_analysis.html#sphx-glr-packages-statistics-auto-examples-plot-iris-analysis-py"><span class="std std-ref">Analysis of Iris petal and sepal sizes</span></a></p>
  <div class="sphx-glr-thumbnail-title">Analysis of Iris petal and sepal sizes</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Fit a simple linear regression using &#x27;statsmodels&#x27;, compute corresponding p-values."><img alt="" src="../../_images/sphx_glr_plot_regression_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_regression.html#sphx-glr-packages-statistics-auto-examples-plot-regression-py"><span class="std std-ref">Simple Regression</span></a></p>
  <div class="sphx-glr-thumbnail-title">Simple Regression</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Wages depend mostly on education. Here we investigate how this dependence is related to gender:..."><img alt="" src="../../_images/sphx_glr_plot_wage_education_gender_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_wage_education_gender.html#sphx-glr-packages-statistics-auto-examples-plot-wage-education-gender-py"><span class="std std-ref">Test for an education/gender interaction in wages</span></a></p>
  <div class="sphx-glr-thumbnail-title">Test for an education/gender interaction in wages</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Calculate using &#x27;statsmodels&#x27; just the best fit, or all the corresponding statistical parameter..."><img alt="" src="../../_images/sphx_glr_plot_regression_3d_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_regression_3d.html#sphx-glr-packages-statistics-auto-examples-plot-regression-3d-py"><span class="std std-ref">Multiple Regression</span></a></p>
  <div class="sphx-glr-thumbnail-title">Multiple Regression</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This example uses seaborn to quickly plot various factors relating wages, experience and educti..."><img alt="" src="../../_images/sphx_glr_plot_wage_data_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_wage_data.html#sphx-glr-packages-statistics-auto-examples-plot-wage-data-py"><span class="std std-ref">Visualizing factors influencing wages</span></a></p>
  <div class="sphx-glr-thumbnail-title">Visualizing factors influencing wages</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This is a business-intelligence (BI) like application."><img alt="" src="../../_images/sphx_glr_plot_airfare_thumb.png" />
<p><a class="reference internal" href="auto_examples/plot_airfare.html#sphx-glr-packages-statistics-auto-examples-plot-airfare-py"><span class="std std-ref">Air fares before and after 9/11</span></a></p>
  <div class="sphx-glr-thumbnail-title">Air fares before and after 9/11</div>
</div></div><div class="toctree-wrapper compound">
</div>
</section>
<section id="solutions-to-this-chapter-s-exercises">
<h2><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">3.1.7. </span>Solutions to this chapter’s exercises</a><a class="headerlink" href="#solutions-to-this-chapter-s-exercises" title="Link to this heading">¶</a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Going back to the brain size + IQ data, test if the VIQ of male and female are different after ..."><img alt="" src="../../_images/sphx_glr_plot_brain_size_thumb.png" />
<p><a class="reference internal" href="auto_examples/solutions/plot_brain_size.html#sphx-glr-packages-statistics-auto-examples-solutions-plot-brain-size-py"><span class="std std-ref">Relating Gender and IQ</span></a></p>
  <div class="sphx-glr-thumbnail-title">Relating Gender and IQ</div>
</div></div><div class="toctree-wrapper compound">
</div>
<div class="sphx-glr-footer sphx-glr-footer-gallery docutils container">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1b9ca3c48567ac6a258ea9a99b43bea0/auto_examples_python.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">auto_examples_python.zip</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/0f7a3cacf11ec37fcbe522bb150f459a/auto_examples_jupyter.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Jupyter</span> <span class="pre">notebooks:</span> <span class="pre">auto_examples_jupyter.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
<p><div style="clear: both"></div></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">3.1. Statistics in Python</a><ul>
<li><a class="reference internal" href="#data-representation-and-interaction">3.1.1. Data representation and interaction</a><ul>
<li><a class="reference internal" href="#data-as-a-table">3.1.1.1. Data as a table</a></li>
<li><a class="reference internal" href="#the-pandas-data-frame">3.1.1.2. The pandas data-frame</a><ul>
<li><a class="reference internal" href="#creating-dataframes-reading-data-files-or-converting-arrays">Creating dataframes: reading data files or converting arrays</a></li>
<li><a class="reference internal" href="#manipulating-data">Manipulating data</a></li>
<li><a class="reference internal" href="#plotting-data">Plotting data</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#hypothesis-testing-comparing-two-groups">3.1.2. Hypothesis testing: comparing two groups</a><ul>
<li><a class="reference internal" href="#student-s-t-test-the-simplest-statistical-test">3.1.2.1. Student’s t-test: the simplest statistical test</a><ul>
<li><a class="reference internal" href="#one-sample-tests-testing-the-value-of-a-population-mean">One-sample tests: testing the value of a population mean</a></li>
<li><a class="reference internal" href="#two-sample-t-test-testing-for-difference-across-populations">Two-sample t-test: testing for difference across populations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#paired-tests-repeated-measurements-on-the-same-individuals">3.1.2.2. Paired tests: repeated measurements on the same individuals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-models-multiple-factors-and-analysis-of-variance">3.1.3. Linear models, multiple factors, and analysis of variance</a><ul>
<li><a class="reference internal" href="#formulas-to-specify-statistical-models-in-python">3.1.3.1. “formulas” to specify statistical models in Python</a><ul>
<li><a class="reference internal" href="#a-simple-linear-regression">A simple linear regression</a></li>
<li><a class="reference internal" href="#categorical-variables-comparing-groups-or-multiple-categories">Categorical variables: comparing groups or multiple categories</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiple-regression-including-multiple-factors">3.1.3.2. Multiple Regression: including multiple factors</a></li>
<li><a class="reference internal" href="#post-hoc-hypothesis-testing-analysis-of-variance-anova">3.1.3.3. Post-hoc hypothesis testing: analysis of variance (ANOVA)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#more-visualization-seaborn-for-statistical-exploration">3.1.4. More visualization: seaborn for statistical exploration</a><ul>
<li><a class="reference internal" href="#pairplot-scatter-matrices">3.1.4.1. Pairplot: scatter matrices</a></li>
<li><a class="reference internal" href="#lmplot-plotting-a-univariate-regression">3.1.4.2. lmplot: plotting a univariate regression</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-for-interactions">3.1.5. Testing for interactions</a></li>
<li><a class="reference internal" href="#full-code-for-the-figures">3.1.6. Full code for the figures</a></li>
<li><a class="reference internal" href="#solutions-to-this-chapter-s-exercises">3.1.7. Solutions to this chapter’s exercises</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../index.html"
                          title="previous chapter"><span class="section-number">3. </span>Packages and applications</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="auto_examples/plot_paired_boxplots.html"
                          title="next chapter"><span class="section-number">3.1.6.1. </span>Boxplots and paired differences</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/packages/statistics/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="auto_examples/plot_paired_boxplots.html" title="3.1.6.1. Boxplots and paired differences"
             >next</a></li>
        <li class="right" >
          <a href="../index.html" title="3. Packages and applications"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scientific Python Lectures</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">3. </span>Packages and applications</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.1. </span>Statistics in Python</a></li>
     
    <!-- Insert a tip toggle in the navigation bar -->
        <li class="left">
        <!-- On click, expand all tips -->
        <!--
        <a>
            <img src="../../_static/plus.png"
                 alt="Expand tips" style="padding: 1ex;"/>
            <span class="hiddenlink">Collapse document to compact view</span>
        </a>
        -->
        </li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scientific-python-lectures/edit/main/packages/statistics/index.rst">Edit
      <span class="tooltip">
        Improve this page:<br/>Edit it on Github.
      </span>
    </a>
    </li>
    
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>